<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Winner's Curse Adjustment Methods for Summary Statistics from Genome-Wide Association Studies • winnerscurse</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Winner's Curse Adjustment Methods for Summary Statistics from Genome-Wide Association Studies">
<meta property="og:description" content="Designed to provide users with easy access to published methods which aim to 
  correct for Winner's Curse using only summary statistics from genome-wide association studies. With merely estimates of effect size and
  associated standard error for each genetic variant, users are able to implement these methods to obtain 
  more accurate estimates of the true effect sizes. These methods can be applied to data from both 
  quantitative and binary traits.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">winnerscurse</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="articles/index.html">Articles</a>
</li>
<li>
  <a href="reference/index.html">Functions</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/amandaforde/winners_curse" class="external-link">Source</a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">


<div class="section level1">
<div class="page-header"><h1 id="winners-curse-adjustment-methods-for-gwas-summary-statistics">Winner’s Curse Adjustment Methods for GWAS summary statistics<a class="anchor" aria-label="anchor" href="#winners-curse-adjustment-methods-for-gwas-summary-statistics"></a>
</h1></div>
<p>This R package, <code>winnerscurse</code>, has been designed to provide easy access to published methods which aim to correct for <strong><em>Winner’s Curse</em></strong>, using <strong>summary statistics</strong> from genome-wide association studies (GWASs). With merely estimates of the variant-trait association, <code>beta</code>, and corresponding standard error, <code>se</code>, for each variant or single nucleotide polymorphism (SNP), this package permits users to implement adjustment methods to obtain more accurate estimates of the true association values. Methods can be applied to data relating to both quantitative and binary traits. This package contains functions which can be implemented with just the summary statistics from a discovery GWAS as well as functions which require summary data from both discovery and replication GWASs. Users can also obtain confidence intervals and standard errors for certain adjusted association estimates.</p>
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<p>You can install the current version of <code>winnerscurse</code> from <strong>GitHub</strong> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"amandaforde/winnerscurse"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="winners-curse">Winner’s Curse<a class="anchor" aria-label="anchor" href="#winners-curse"></a>
</h3>
<p>The <em>Winner’s Curse</em> is a statistical effect which generally results in the <strong>exaggeration of SNP-trait association estimates</strong> in the study that discovered these associations. To briefly explain this concept further, genome-wide association studies are used to detect genetic variants or SNPs that are associated with a trait of interest and subsequently, estimate the size of these associations. However, due to this phenomenon termed as <em>Winner’s Curse</em>, the association estimates of the variants that are seen to be most associated with the trait in the study tend to be upward biased and greater in magnitude than their true values.</p>
<p>However, <em>Winner’s Curse</em> isn’t just a phenomenon related to genetic association studies and thus, a better understanding of the concept may be gained through reflecting on the following simpler examples.</p>
<p>Firstly, let us consider the English football league, the Premier League, and suppose football players are ranked based on the number of goals scored in one season. The top ranking players, the <em>‘winners’</em>, are most likely players who had an above average season, perhaps those who were at the peak of their career and fitness. However, across many seasons, these highly ranked players may not score as many goals nor be as outstanding consistently. For example, take Leicester City player, <a href="https://www.premierleague.com/players/8979/Jamie-Vardy/overview" class="external-link">Jamie Vardy</a>, for instance, and imagine that we wish to estimate the average number of goals he scores per Premier League season. If we only had information regarding the 2019/2020 season in which he was awarded the Premier League Golden Boot, i.e. he was the leading goalscorer in the league that season, then we would have to use the number of goals he scored that season (23) as an estimate of the average number of goals he scores per season. However, in reality, according to <a href="https://www.premierleague.com/players/8979/Jamie-Vardy/overview" class="external-link">Premier League statistics</a>, between 2014 and 2022, the true average number of goals scored by Jamie Vardy per season was approximately 16.6. Therefore, the estimate of 23 obtained using the single data set from 2019/2020 is clearly an <em>overestimation</em> of the true average number of goals scored by Jamie Vardy per season, demonstrating the <em>Winner’s Curse</em> concept.</p>
<p align="center">
<a href="https://www.lcfc.com/news/1742334/vardy-wins-premier-league-golden-boot" class="external-link"> <img src="https://resources.lcfc.com/leicesterfc/photo/2020/07/26/ba60f5cb-5997-43c2-b1d9-a8380f65e502/AM2Z3333.JPG" height="65%" width="50%"><figcaption><a href="https://www.lcfc.com/news/1742334/vardy-wins-premier-league-golden-boot" class="external-link">https://www.lcfc.com/news/1742334/vardy-wins-premier-league-golden-boot</a>
</figcaption></a>
</p>
<p>In fact, the term <em>Winner’s Curse</em> first arose in the realm of auction theory. Imagine a common value auction in which each potential buyer independently estimates the value of the item up for auction and submits this as their bid. The winner of the auction is then the bidder who makes the highest estimate and thus, has submitted the highest bid. If it is assumed that the average bid is close to the true value of the item, then this <em>winner</em> will most likely <em>pay more</em> for the item than its true value, giving rise to the phenomenon of <em>Winner’s Curse</em>. A nice illustration of this is shown in the image below where we see several cats bidding for a crate of fish. The real value of the crate is shown to be similar to the average of the estimates or bids given by the various cats. This then results in the cat with the highest bid, the <em>winning</em> cat, receiving the crate of fish but also paying much more than the crate’s true value. We say that this cat has then suffered from <em>Winner’s Curse</em>.</p>
<p align="center">
<a href="https://www.nobelprize.org/uploads/2020/10/pop-en-fig2-curse.jpg" class="external-link"> <img src="https://www.nobelprize.org/uploads/2020/10/pop-en-fig2-curse.jpg" height="65%" width="50%"><figcaption><a href="https://www.nobelprize.org/uploads/2020/10/pop-en-fig2-curse.jpg" class="external-link">https://www.nobelprize.org/uploads/2020/10/pop-en-fig2-curse.jpg</a>
</figcaption></a>
</p>
<p>Now, let us reframe this idea of <em>Winner’s Curse</em> in the context of genetic association studies. The <em>‘winners’</em> here are SNPs whose effect sizes are <em>stochastically</em> higher in the discovery study than their true association values. Clearly, these raw effect estimates are therefore biased association estimates, especially for those SNPs who are ranked highly in the study, namely the most significant SNPs. In genetic studies, SNPs are often ranked according to their <span class="math inline"><em>z</em></span>-statistics or corresponding <span class="math inline"><em>p</em></span>-values, and are deemed as <em>significant</em> if their <span class="math inline"><em>p</em></span>-values are less than a pre-specified threshold. The most common threshold used in this instance is the genome-wide significance threshold of <span class="math inline">5 × 10<sup>−8</sup></span>.</p>
<p><span style="color: blue;"><span class="math inline">⋆</span></span> <strong>Note:</strong> The <strong>goal</strong> of the functions then in this package is to adjust the raw effect estimates, <code>beta</code>, rendering them less biased and <em>more accurate</em>. Several functions in this package can make adjustments using only the summary statistics obtained from a single discovery study.</p>
</div>
<div class="section level3">
<h3 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h3>
<p>We now discuss a simple simulated data set of GWAS summary statistics, providing an alternative manner in which to comprehend the Winner’s Curse with a visual representation of the bias induced. We simulate summary statistics for a quantitative trait with a normal effect size distribution under the assumption that SNPs are independent. We assume a fixed array of 1,000,000 SNPs in which 1% have a true effect on the trait. In addition, we fix the heritability of the trait as moderate with a value of 0.4 and suppose that a total of 50,000 individuals have been sampled in the study. This is a similar toy data set to that used in the first vignette, <a href="https://amandaforde.github.io/winnerscurse/articles/winners_curse_methods.html" class="external-link">‘Methods for use with discovery GWAS’</a> and thus, a more detailed description of how the function <code>sim_stats</code> was used to simulate this data set can be found there.</p>
<p>The true effect sizes, <code>true_beta</code>, were first generated and then used to simulate <em>one</em> effect estimate, <code>beta_hat</code> for each SNP. This process is similar to performing a single GWAS or only having access to the goals scored by football players in <em>one</em> league season. In this simulation scenario, we can thus easily compare <code>beta_hat</code> with <code>beta</code> for each SNP. With real data sets, we are not as fortunate and hence, this provides motivation to establish suitable <em>Winner’s Curse</em> correction methods which will aim to reduce or eliminate the bias witnessed in the effect estimates of significant SNPs. The table below shows the 6 SNPs in our toy data set which have been deemed most extreme according to their <span class="math inline"><em>z</em></span>-statistic. It contains the values for <code>beta_hat</code> and <code>true_beta</code>, with the bias induced by <em>Winner’s Curse</em> evident. 5 of the <code>beta_hat</code> values are an <em>overestimation</em> of their corresponding true effect size.</p>
<p align="center">
<a href="https://github.com/amandaforde/winnerscurse_sims/blob/main/package_image1.PNG?raw=true" class="external-link"> <img src="https://github.com/amandaforde/winnerscurse_sims/blob/main/package_image1.PNG?raw=true" width="40%"></a>
</p>
<p>In addition to the above table, there are a number of ways in which we can attempt to visualise the existence of <em>Winner’s Curse</em> in our toy data set. Firstly, in a similar manner to how we visualise results in the <a href="https://amandaforde.github.io/winnerscurse/articles/winners_curse_methods.html" class="external-link">first vignette</a>, we can construct a <strong>density</strong> plot of the true absolute effect sizes, <span class="math inline">|<em>β</em>|</span>, along with the estimated absolute effect sizes, <span class="math inline">|<em>β̂</em>|</span>, for the 34 SNPs which have been deemed significant according to the genome-wide significance threshold of <span class="math inline">5 × 10<sup>−8</sup></span>. In the plot below, these effect sizes are termed as ‘true’ and ‘naive’, respectively. As expected, we witness the <span style="color: #1b9e77;"><strong>turquoise</strong></span> curve of the estimated effect, ‘naive’, lying to the right of the true effect <span style="color: #d95f02;"><strong>orange</strong></span> curve, ‘true’. This provides a strong indication that a large number of the estimated effects of these extreme SNPs are greater than their corresponding true values.</p>
<p align="center">
<a href="https://github.com/amandaforde/winnerscurse_sims/blob/main/package_image2.PNG?raw=true" class="external-link"> <img src="https://github.com/amandaforde/winnerscurse_sims/blob/main/package_image2.PNG?raw=true" width="60%"></a>
</p>
<p>Therefore, in visual terms, we would like the functions of our package to produce estimates which are more in line with the true values, i.e. shifted more towards the <span style="color: #d95f02;"><strong>orange</strong></span> density plot on the left, avoiding the obvious inflation incurred by the ‘naive’ association estimates here.</p>
<p>Another interesting way in which this <em>Winner’s Curse</em> induced bias can be visualised is to plot <code>z</code> vs <code>bias</code> for the simulated data set in which <code>z</code> = <code>beta_hat</code>/<code>se</code> and <code>bias</code> = <code>beta_hat</code> - <code>beta</code>. This <code>z</code> vs <code>bias</code> plot takes the same form as those seen in S2 Fig in <a href="https://journals.plos.org/plosgenetics/article?id=10.1371/journal.pgen.1010546" class="external-link">Forde <em>et al.</em> (2023)</a>. In the plot below, the <span style="color:red;"><strong>bright red</strong></span> line corresponds to the significance threshold of <span class="math inline">5 × 10<sup>−8</sup></span> while the <span style="color:darkred;"><strong>darker red</strong></span> line relates to <span class="math inline">5 × 10<sup>−4</sup></span>. The points corresponding to SNPs which are significantly overestimated and are significant at a threshold of <code>5e-4</code> are coloured in <span style="color:grey;"><strong>grey</strong></span>. A SNP is defined as being significantly overestimated or as having a significantly more extreme effect size estimate, at the 2.5% significance level, if it satisfies the condition: |<code>beta_hat</code>| &gt; |<code>beta</code>| + 1.96<code>se</code>. It can be seen clearly in the plot below that significant SNPs with negative <em>z</em>-statistics tend to also have negative <code>bias</code> values and vice versa for the significant SNPs with positive <em>z</em>-statistics, which is as expected due to <em>Winner’s Curse</em>.</p>
<p align="center">
<a href="https://github.com/amandaforde/winnerscurse_sims/blob/main/package_image3.PNG?raw=true" class="external-link"> <img src="https://github.com/amandaforde/winnerscurse_sims/blob/main/package_image3.PNG?raw=true" width="55%"></a>
</p>
<p><span style="color: blue;"><span class="math inline">⋆</span></span> <strong>Note:</strong> In order to appropriately use the functions in this package, GWAS summary statistics must be in the form of a <strong>data frame with three columns <code>rsid</code>, <code>beta</code> and <code>se</code></strong>, in which the first column, titled <code>rsid</code>, contains the SNP ID number, the second column, named <code>beta</code>, contains the effect size estimate while the third column, <code>se</code> holds the corresponding estimated standard error.</p>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing winnerscurse</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Amanda Forde <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-7940-3413" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/amandaforde/winnerscurse/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/amandaforde/winners_curse/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://app.codecov.io/gh/amandaforde/winnerscurse" class="external-link"><img src="https://codecov.io/gh/amandaforde/winnerscurse/branch/main/graph/badge.svg?token=BORRC1EUZ7" alt="codecov"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Amanda Forde.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
