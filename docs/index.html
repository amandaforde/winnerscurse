<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Winner's Curse Adjustment Methods for GWAS Summary Statistics • winnerscurse</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Winner's Curse Adjustment Methods for GWAS Summary Statistics">
<meta property="og:description" content="A package designed to provide easy access to published methods which aim to 
  correct for Winner's Curse using only GWAS summary statistics. With merely estimates of beta and 
  associated standard error for each SNP, users are able to implement these methods to obtain 
  less biased estimates of the true beta values. These methods can be applied to data from both 
  quantitative and binary traits.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">winnerscurse</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/winners_curse_methods.html">Obtaining adjusted `beta` estimates</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="winners-curse-adjustment-methods-for-gwas-summary-statistics" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#winners-curse-adjustment-methods-for-gwas-summary-statistics" class="anchor"></a>Winner’s Curse Adjustment Methods for GWAS summary statistics</h1></div>
<!-- badges: start -->

<p>This package has been designed to provide easy access to published methods which aim to correct for Winner’s Curse, using GWAS summary statistics. With merely estimates of the association, <code>beta</code>, and corresponding standard error, <code>se</code>, for each SNP, this package permits users to implement adjustment methods to obtain less biased estimates of the true <code>beta</code> values. Methods can be applied to data relating to both quantitative and binary traits.</p>
<div id="installation" class="section level3">
<h3 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h3>
<p>You can install the current version of <code>winnerscurse</code> from GitHub with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages("devtools")</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"amandaforde/winnerscurse"</span><span class="op">)</span></code></pre></div>
</div>
<div id="winners-curse" class="section level3">
<h3 class="hasAnchor">
<a href="#winners-curse" class="anchor"></a>Winner’s Curse</h3>
<p>The Winner’s Curse is a statistical effect resulting in the exaggeration of SNP-trait association estimates in the sample in which these associations were discovered.</p>
<p>However, the Winner’s Curse isn’t just a phenomenon related to GWAS. An understanding of Winner’s Curse may be gained through the following simple example. Consider rugby players who are ranked based on the number of points scored in one World Cup tournament. The top ranking players, the <em>‘winners’</em>, are most likely players who had an above average tournament, perhaps those who were at the peak of their career and fitness. However, across many tournaments, these highly ranked players may not score as many points nor be as outstanding consistently.</p>
<p>Now, let us reframe this idea in the context of GWAS. The <em>‘winners’</em> here are SNPs whose effect sizes are <em>stochastically</em> higher in the discovery study than their true association values. Clearly, these raw effect estimates are therefore biased estimates of <code>beta</code>, especially for those SNPs who are ranked highly in the study - the most significant SNPs. SNPs are often ranked according to their <em>z</em>-statistics or corresponding <em>p</em>-values.</p>
<p>The goal of the functions in this package is to adjust the raw effect estimates, <code>beta</code>, rendering them less biased. These adjustments are made using only the summary statistics obtained from the discovery study.</p>
<p><strong>Simple Example:</strong></p>
<p>We will now discuss a simple simulated data set, providing another way of comprehending the Winner’s Curse with the assistance of a plot. However, remember throughout that this is very much a hypothetical data set used for demonstration purposes and does not resemble a true data set that one would obtain in a GWAS.</p>
<p>Let us first generate 1000 values from a standard normal distribution, centred at 0 with standard deviation of 1. We allow these values to act as the <em>true</em> effect sizes of 1000 independent SNPs.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1948</span><span class="op">)</span>
<span class="va">beta</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1000</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>
<span class="va">beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">1000</span>, beta <span class="op">=</span> <span class="va">beta</span><span class="op">)</span></code></pre></div>
<p>Next, we use these true effect sizes to simulate <em>one</em> effect estimate for each SNP - this is similar to performing a single GWAS study or looking at points scored by players in one World Cup tournament. We imagine that the effect size of each SNP also follows a normal distribution which is centred at its true effect size, <code>beta</code> and has a standard deviation of 0.5. This value of 0.5 is only used for convenience and in general, each SNP would have its own individual value here. Therefore, <code>beta_hat</code> below can be understood as a vector of estimates of effect sizes obtained from one study. We then re-arrange our data set so that SNPs are now ordered based on decreasing absolute <code>beta_hat</code> values and have a look at the 6 most extreme SNPs. As this data set is simulated, we know the true <code>beta</code> values and thus, can easily compare <code>beta_hat</code> with <code>beta</code> for each SNP. With real data sets, we are not as fortunate. From the table below, the bias induced by Winner’s Curse is evident. Each <code>beta_hat</code> value is an <em>overestimation</em> of its corresponding true effect size.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">beta_hat</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1000</span>,<span class="va">beta</span><span class="op">$</span><span class="va">beta</span>,<span class="fl">0.5</span><span class="op">)</span>  
<span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">beta</span>, <span class="va">beta_hat</span><span class="op">)</span>
<span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu">desc</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">beta_hat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/amandaforde/winnerscurse/main/winnerscurse.PNG"></p>
<p>Plotting the distribution of the true absolute effect sizes for the SNPs which have been ranked in the top 50 together with the estimated absolute effect sizes from this study allows us visualize Winner’s Curse. As expected, we witness the orange curve of the estimated effects lying to the right of the true effect turquoise curve. This provides a strong indication that a large number of the estimated effects of these extreme SNPs are greater than their corresponding true value.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">RColorBrewer</span><span class="op">)</span>
<span class="va">col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">3</span>,<span class="st">"Dark2"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">beta</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1.4</span><span class="op">)</span>,xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">4.5</span><span class="op">)</span>, main<span class="op">=</span><span class="st">"Visualisation of Winner's Curse"</span>, col<span class="op">=</span><span class="va">col</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">beta_hat</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, col<span class="op">=</span><span class="va">col</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/amandaforde/winnerscurse/main/readme_plot.png"></p>
<p>Therefore, in visual terms, we would like the functions of our package to produce estimates which are more in line with the true values, i.e. shifted more towards the turquoise density plot on the left, avoiding the obvious inflation incurred by the raw <code>beta_hat</code> estimates here.</p>
<p><strong>Note:</strong> The above data is <em>not</em> suitable for use with the functions in this package. It has merely been used a very simple example to demonstrate the concept of winner’s curse. In order to appropriately use the functions, summary statistics must be in the form of a <strong>data frame</strong> in which the first column, titled <code>rsid</code>, contains the SNP ID number, the second column, named <code>beta</code>, contains the effect size estimate while the third column, <code>se</code> holds the corresponding estimated standard error.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Amanda Forde <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/amandaforde/winners_curse/actions"><img src="https://github.com/amandaforde/winners_curse/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Amanda Forde.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
