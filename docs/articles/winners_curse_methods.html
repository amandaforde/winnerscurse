<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Methods for use with discovery GWAS • winnerscurse</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Methods for use with discovery GWAS">
<meta property="og:description" content="winnerscurse">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">winnerscurse</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/amandaforde/winners_curse" class="external-link">Source</a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Methods for use with discovery GWAS</h1>
            
      
      
      <div class="hidden name"><code>winners_curse_methods.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://amandaforde.github.io/winnerscurse/" class="external-link">winnerscurse</a></span><span class="op">)</span></code></pre></div>
<p>In order to demonstrate how this package can be used to obtain new
adjusted <span class="math inline">\(\hat\beta\)</span> estimates, we
first create a toy data set and subsequently, illustrate how a user
could engage with each of the package’s functions using this data set.
The methods currently available for implementation are:</p>
<ol style="list-style-type: decimal">
<li>Conditional Likelihood methods - <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2665019/" class="external-link">Ghosh
<em>et al.</em> (2008)</a>
</li>
<li>Empirical Bayes method - <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4048064/" class="external-link">Ferguson
<em>et al.</em> (2013)</a>
</li>
<li>FDR Inverse Quantile Transformation method - <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5013908/" class="external-link">Bigdeli
<em>et al.</em> (2016)</a>
</li>
<li>Bootstrap method - adapted from <a href="https://onlinelibrary.wiley.com/doi/abs/10.1002/sim.4228" class="external-link">Faye
<em>et al.</em> (2011)</a>
</li>
</ol>
<p>An important feature which distinguishes these four methods is
detailed in the table below:</p>
<table class="table">
<colgroup>
<col width="53%">
<col width="47%">
</colgroup>
<thead><tr class="header">
<th>Adjusts <span class="math inline">\(\beta\)</span> estimate of
<em>only</em> SNPs with <span class="math inline">\(p\)</span>-values
less than specified threshold, <span class="math inline">\(\alpha\)</span>
</th>
<th>Adjusts <span class="math inline">\(\beta\)</span> estimate of
<em>all</em> SNPs</th>
</tr></thead>
<tbody><tr class="odd">
<td><ul>
<li>Conditional Likelihood methods</li>
</ul></td>
<td><ul>
<li>Empirical Bayes method</li>
<li>FDR Inverse Quantile Transformation method</li>
<li>Bootstrap method</li>
</ul></td>
</tr></tbody>
</table>
<div class="section level3">
<h3 id="creating-a-toy-data-set">Creating a toy data set<a class="anchor" aria-label="anchor" href="#creating-a-toy-data-set"></a>
</h3>
<ul>
<li><p>We wish to generate summary statistics for 1 million SNPs, in
which there exists a polygenic background of 10,000 SNPs while all
others have no effects.</p></li>
<li>
<p>We specify:</p>
<ol style="list-style-type: decimal">
<li>the total number of SNPs</li>
<li>the number of SNPs truly associated with the trait</li>
<li>the number of samples</li>
<li>the minor allele frequency of each SNP</li>
<li>the variance explained in the trait by all SNPs, <span class="math inline">\(h^2\)</span>
</li>
</ol>
</li>
<li><p>With these specifications, we can obtain quite realistic summary
statistics as shown below.</p></li>
<li><p>The summary statistics have been arranged here in a suitable way
for each method - in the form of a <strong>data frame with columns
<code>rsid</code>, <code>beta</code> and
<code>se</code>.</strong></p></li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1998</span><span class="op">)</span>

<span class="va">n_snps</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">^</span><span class="fl">6</span>
<span class="va">n_samples</span> <span class="op">&lt;-</span> <span class="fl">30000</span>
<span class="va">effect_snps</span> <span class="op">&lt;-</span> <span class="fl">0.01</span><span class="op">*</span><span class="va">n_snps</span>
<span class="va">maf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n_snps</span>,<span class="fl">0.01</span>,<span class="fl">0.5</span><span class="op">)</span>
<span class="va">true_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">effect_snps</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>
<span class="va">h2</span> <span class="op">&lt;-</span> <span class="fl">0.7</span>  <span class="co"># variance explained by effect SNPs</span>
<span class="va">var_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">maf</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">effect_snps</span><span class="op">]</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">maf</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">effect_snps</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="va">true_beta</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="va">h2</span>
<span class="va">true_beta</span> <span class="op">&lt;-</span> <span class="va">true_beta</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">var_y</span><span class="op">)</span> <span class="co"># scaling to represent a phenotype with variance 1</span>
<span class="va">true_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">true_beta</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">n_snps</span><span class="op">-</span><span class="va">effect_snps</span><span class="op">)</span><span class="op">)</span>
<span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fl">2</span><span class="op">*</span><span class="va">maf</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">maf</span><span class="op">)</span><span class="op">*</span><span class="va">true_beta</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">n_samples</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="va">maf</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">maf</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="va">summary_stats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>rsid<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">n_snps</span><span class="op">)</span>,beta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="va">n_snps</span>,mean<span class="op">=</span><span class="va">true_beta</span>,sd<span class="op">=</span><span class="va">se</span><span class="op">)</span>,se<span class="op">=</span><span class="va">se</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">summary_stats</span><span class="op">)</span>
<span class="co">#&gt;   rsid         beta          se</span>
<span class="co">#&gt; 1    1 -0.014621777 0.024816486</span>
<span class="co">#&gt; 2    2  0.003693032 0.011860650</span>
<span class="co">#&gt; 3    3 -0.056895857 0.021248869</span>
<span class="co">#&gt; 4    4 -0.023764922 0.025252738</span>
<span class="co">#&gt; 5    5  0.028410276 0.008177783</span>
<span class="co">#&gt; 6    6 -0.001963061 0.009937206</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="method-1-conditional-likelihood">Method 1: Conditional Likelihood<a class="anchor" aria-label="anchor" href="#method-1-conditional-likelihood"></a>
</h3>
<ul>
<li><p>The function <code>conditional_likelihood</code> requires a data
frame, in the form described above, and a value for <code>alpha</code>,
the significance threshold used in the GWAS. Note that all columns of
the data frame must contain numerical values and each row must represent
a unique SNP, identified by <code>rsid</code>.</p></li>
<li><p>As the conditional likelihood methods have been designed to be
only used for SNPs which are deemed significant, the data frame returned
contains only SNPs that have <span class="math inline">\(p\)</span>-values below the inputted genome-wide
significance threshold value, <code>alpha</code>.</p></li>
<li><p><strong>Note:</strong> If the -statistic of a particular SNP is
greater than 100, then merely the original naive estimate will be
outputted for the second form of the adjusted estimate, namely , for
that SNP.</p></li>
<li><p>If no SNPs are detected as significant, the function returns a
warning message:
<code>WARNING: There are no significant SNPs at this threshold</code>.</p></li>
<li><p>The returned data frame has SNPs ordered based on their <span class="math inline">\(p\)</span>-values from smallest to largest, or
equivalently, in descending order of <span class="math inline">\(\mid z
\mid\)</span> in which <span class="math inline">\(z\)</span> is the
estimated value for <span class="math inline">\(\beta\)</span> divided
by its standard error.</p></li>
<li><p>We implement the function on our toy data set as follows,
choosing a significance threshold of <code>5e-8</code>:</p></li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">out_CL</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/conditional_likelihood.html">conditional_likelihood</a></span><span class="op">(</span>summary_data <span class="op">=</span> <span class="va">summary_stats</span>, alpha <span class="op">=</span> <span class="fl">5e-8</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">out_CL</span><span class="op">)</span>
<span class="co">#&gt;   rsid        beta          se    beta.cl1    beta.cl2    beta.cl3</span>
<span class="co">#&gt; 1 3965  0.06064760 0.008191123  0.06007537  0.05868216  0.05937877</span>
<span class="co">#&gt; 2 7815  0.06273204 0.008477889  0.06213363  0.06068292  0.06140827</span>
<span class="co">#&gt; 3 4998 -0.05956742 0.008336576 -0.05853885 -0.05655174 -0.05754529</span>
<span class="co">#&gt; 4 7261  0.05510736 0.008186396  0.05271740  0.04940315  0.05106028</span>
<span class="co">#&gt; 5 6510  0.05623389 0.008389116  0.05363848  0.05011923  0.05187885</span>
<span class="co">#&gt; 6 9917  0.05466029 0.008176299  0.05203604  0.04852832  0.05028218</span></code></pre></div>
<ul>
<li><p>Three columns have been added to the right of the inputted data
frame: each represents a correction method suggested in <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2665019/" class="external-link">Ghosh
<em>et al.</em> (2008)</a>. The first, <code>beta.cl1</code>, is
referred to as the conditional MLE while the second,
<code>beta.cl2</code>, is the mean of the normalized conditional
likelihood. The third, <code>beta.cl3</code> is merely the average of
the first two, known as the compromise estimator.</p></li>
<li><p>Ghosh <em>et al.</em> (2008) noted that for instances in which
the true <span class="math inline">\(\beta\)</span> value is close to
zero, <code>beta.cl2</code> often has greater mean squared error than
<code>beta.cl1</code> but for true <span class="math inline">\(\beta\)</span> values further from zero,
<code>beta.cl2</code> performs better. Thus, it was suggested that
<code>beta.cl3</code> be used to combine the strengths of these two
estimators. However, this function, <code>conditional_likelihood</code>,
outputs values for all three estimators in order to allow the user to
make their own decision on which they believe to be the most
appropriate.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="method-2-empirical-bayes">Method 2: Empirical Bayes<a class="anchor" aria-label="anchor" href="#method-2-empirical-bayes"></a>
</h3>
<ul>
<li><p>The function <code>empirical_bayes</code> implements the
Empirical Bayes method for correcting for Winner’s Curse, detailed in <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4048064/" class="external-link">Ferguson
<em>et al.</em> (2013)</a>, with a slight modification.</p></li>
<li><p>The function has two arguments with the first being
<code>summary_data</code>, the data frame containing <code>rsid</code>,
<code>beta</code> and <code>se</code> columns. Again, all columns of the
data frame must contain numerical values and each row must represent a
unique SNP, identified by <code>rsid</code>. In addition, the function
requires that the data frame must contain at least 50 rows corresponding
to 50 unique SNPs. This requirement is included as the Empirical Bayes
method performs poorly when only data of a small number of SNPs is
available. The second argument, <code>method</code>, is a string
parameter which allows the user to choose what modelling approach to
take for the purpose of estimating the log density function. The default
setting is <code>method="AIC"</code>, which is the current published
method. Other options include <code>method="fix_df"</code>,
<code>method="scam"</code>, <code>method="gam_nb"</code> and
<code>method="gam_po"</code>. If <code>method="fix_df"</code>, the
degrees of freedom is set to 7. The other three options all enforce
additional constraints on the shape of the estimated log density
function by i) fitting a generalized additive model (GAM), with
integrated smoothness estimation, (<code>method="gam_nb"</code> and
<code>method="gam_po"</code>) and ii) applying two shape constrained
additive models (SCAMs) (<code>method="scam"</code>).</p></li>
<li><p>It returns the above described data frame but with a fourth
column, <code>beta_EB</code> in which the adjusted estimates of this
procedure have been added.</p></li>
<li><p>As the Empirical Bayes method makes adjustments to all SNPs, not
only those that have been considered significant, this data frame
contains all SNPs.</p></li>
<li><p><strong>Note:</strong> The conditional likelihood methods adjust
each statistic one at a time, and so summary statistics of one
individual SNP can easily be inputted into the
<code>conditional_likelihood</code> function. However, the Empirical
Bayes method requires many SNPs as the more information given to the
function, the more accurate it will be at modelling the distribution and
thus, making adjustments. Thus, as mentioned above,
<code>summary_data</code> must contain information related to more than
50 SNPs.</p></li>
<li><p>Below is a demonstration of using <code>empirical_bayes</code>
with our toy data set with the default setting for
<code>method</code>:</p></li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">out_EB</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/empirical_bayes.html">empirical_bayes</a></span><span class="op">(</span>summary_data <span class="op">=</span> <span class="va">summary_stats</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">out_EB</span><span class="op">)</span>
<span class="co">#&gt;   rsid        beta          se     beta_EB</span>
<span class="co">#&gt; 1 3965  0.06064760 0.008191123  0.05177699</span>
<span class="co">#&gt; 2 7815  0.06273204 0.008477889  0.05355088</span>
<span class="co">#&gt; 3 4998 -0.05956742 0.008336576 -0.05107993</span>
<span class="co">#&gt; 4 7261  0.05510736 0.008186396  0.04624187</span>
<span class="co">#&gt; 5 6510  0.05623389 0.008389116  0.04714887</span>
<span class="co">#&gt; 6 9917  0.05466029 0.008176299  0.04580573</span></code></pre></div>
<ul>
<li><p>Unfortunately, the Empirical Bayes estimator described by
Ferguson <em>et al.</em> (2013) is known to perform poorly in the
extreme tails of the distribution. Therefore, it is quite possible that
a lack of adjustment for the <span class="math inline">\(\beta\)</span>
values of SNPs with the most extreme <span class="math inline">\(z\)</span>-statistics could be witnessed with this
method. A somewhat ad hoc approach to overcome this issue of combining
the Empirical Bayes and the conditional likelihood methods was suggested
by Ferguson <em>et al.</em> (2013).</p></li>
<li><p>In order to ensure that shrinkage does occur for the <span class="math inline">\(\beta\)</span> values of these extreme SNPs, it
was decided that the following modification would be added to the
<code>empirical_bayes</code> function detailed here. The basis function
of the natural cubic spline has been altered so that the boundary knots
are no longer the most extreme <span class="math inline">\(z\)</span>-values. Instead, the lower boundary
knot is defined as the <span class="math inline">\(10^{\text{th}}\)</span> <span class="math inline">\(z\)</span>-statistic when the <span class="math inline">\(z\)</span>-statistics lie in increasing order
while the upper boundary knot is the <span class="math inline">\(10^{\text{th}}\)</span> <span class="math inline">\(z\)</span>-statistic when the <span class="math inline">\(z\)</span>-statistics have been arranged in
decreasing order. The natural cubic spline is then merely linear beyond
these boundary knots. This assists in fixing the ‘tails’ issue discussed
above. We see that the reduction of the estimated <span class="math inline">\(\beta\)</span> values for all of the top 6 most
significant SNPs has occurred.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="method-3-fdr-inverse-quantile-transformation">Method 3: FDR Inverse Quantile Transformation<a class="anchor" aria-label="anchor" href="#method-3-fdr-inverse-quantile-transformation"></a>
</h3>
<ul>
<li><p>The function <code>FDR_IQT</code> implements the winner’s curse
adjustment method detailed in <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5013908/" class="external-link">Bigdeli
<em>et al.</em> (2016)</a>.</p></li>
<li><p>Similar to the approaches above, the function requires a data
frame with three columns <code>rsid</code>, <code>beta</code> and
<code>se</code>, all columns of the data frame must contain numerical
values and each row must represent a unique SNP, identified by
<code>rsid</code>.</p></li>
<li><p>It also has an argument <code>min_pval</code>, for which the
default setting is <code>1e-15</code>. This is included in order to
avoid zero <span class="math inline">\(p\)</span>-values which can prove
problematic for the function when evaluating <code><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm()</a></code>.
Furthermore, due to the nature of winner’s curse, it is in fact rare
that observations with <span class="math inline">\(\mid z \mid &gt;
8\)</span> are biased.</p></li>
<li><p>However, through the third argument <code>method</code>, this
function also provides the user with an option to use an alternative
form of FDR Inverse Quantile Transformation which will adjust the effect
sizes of all SNPs, not only those that have <span class="math inline">\(p\)</span>-values greater than <code>1e-15</code>.
The default setting is <code>method="original"</code> while our modified
version of the method can be executed using
<code>method="alt"</code>.</p></li>
</ul>
<p><span class="math inline">\(~\)</span></p>
<p><strong>Alternative method description:</strong></p>
<ul>
<li><p>As mentioned above, the current published definition of FDR
Inverse Quantile Transformation contains the clause that if a certain
SNP has a <span class="math inline">\(p\)</span>-value which equates to
0 or indeed a <span class="math inline">\(p\)</span>-value less than
<code>1e-15</code>, then the association estimate of this SNP will not
be adjusted. This motivated us to explore a way in which we could obtain
adjusted estimates for these SNPs with very small <span class="math inline">\(p\)</span>-values or equivalently, very large
<span class="math inline">\(z\)</span>-statistics.</p></li>
<li><p>It is possible to prove that for all <span class="math inline">\(z &gt; 0\)</span>, the following identity holds:
<span class="math inline">\(P(N(0,1) &gt; z) \le
\frac{e^-{\frac{z^2}{2}}}{z\sqrt{2\pi}}\)</span>. However, <span class="math inline">\(\frac{\frac{e^-{\frac{z^2}{2}}}{z\sqrt{2\pi}}}{P(N(0,1)
&gt; z)} \rightarrow 1\)</span> as <span class="math inline">\(z
\rightarrow \infty\)</span>, and therefore, we can in fact use the
following as an approximation to <span class="math inline">\(2 \times
P(N(0,1) &gt; |z|)\)</span> for large <span class="math inline">\(z\)</span>: <span class="math display">\[2 \times
\frac{e^{-\frac{|z|^2}{2}}}{|z|\sqrt{2\pi}}\]</span></p></li>
<li><p>Thus, using this identity, we established an alternative form of
FDR IQT in which adjustments can be made to the <span class="math inline">\(z\)</span>-statistics of all SNPs, including those
with <span class="math inline">\(p\)</span>-values less than
<code>1e-15</code>. Our proposed alternative method first replaces the
current <span class="math inline">\(p\)</span>-values of those SNPs with
very small <span class="math inline">\(p\)</span>-values with substitute
<span class="math inline">\(p\)</span>-values using the above equation.
Following this, in a similar manner to the original method, the function
<code>p.adjust</code> is applied to all <span class="math inline">\(p\)</span>-values. Corresponding adjusted <span class="math inline">\(z\)</span>-statistics are then obtained for each
SNP using the <code>qnorm</code> function. Our method then creates a
look-up table which includes <span class="math inline">\(z\)</span>-statistics ranging from a value of 8 up
to the minimum positive integer that is greater than the maximum <span class="math inline">\(z\)</span>-statistic of the data set at hand, at
increments of 0.0001. For each <span class="math inline">\(z\)</span>-statistic, an approximate <span class="math inline">\(p\)</span>-value is obtained using the equation:
<span class="math inline">\(2 \times
\frac{e^{-\frac{|z|^2}{2}}}{|z|\sqrt{2\pi}}\)</span>. For those adjusted
<span class="math inline">\(z\)</span>-statistics which have been
computed as equating to infinity, this look-up table is used along with
the adjusted <span class="math inline">\(p\)</span>-values in order to
obtain a more suitable value for the adjusted <span class="math inline">\(z\)</span>-statistic. Thus, in contrast to the
original definition, these SNPs with very large <span class="math inline">\(z\)</span>-statistics now have been provided with
values for adjusted <span class="math inline">\(z\)</span>-statistics.</p></li>
</ul>
<p><span class="math inline">\(~\)</span></p>
<ul>
<li>The function outputs a data frame similar to that inputted with an
additional column containing the adjusted estimate,
<code>beta_FIQT</code>, and again, the SNPs have been reordered
according to their individual <span class="math inline">\(z\)</span>-statistics.</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">out_FIQT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/FDR_IQT.html">FDR_IQT</a></span><span class="op">(</span>summary_data <span class="op">=</span> <span class="va">summary_stats</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">out_FIQT</span><span class="op">)</span>
<span class="co">#&gt;   rsid        beta          se   beta_FIQT</span>
<span class="co">#&gt; 1 3965  0.06064760 0.008191123  0.04419398</span>
<span class="co">#&gt; 2 7815  0.06273204 0.008477889  0.04574119</span>
<span class="co">#&gt; 3 4998 -0.05956742 0.008336576 -0.04271559</span>
<span class="co">#&gt; 4 7261  0.05510736 0.008186396  0.03781859</span>
<span class="co">#&gt; 5 6510  0.05623389 0.008389116  0.03875509</span>
<span class="co">#&gt; 6 9917  0.05466029 0.008176299  0.03777195</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="method-4-bootstrap">Method 4: Bootstrap<a class="anchor" aria-label="anchor" href="#method-4-bootstrap"></a>
</h3>
<ul>
<li><p>Inspired by the bootstrap resampling method detailed in <a href="https://onlinelibrary.wiley.com/doi/abs/10.1002/sim.4228" class="external-link">Faye
<em>et al.</em> (2011)</a>, the function <code>BR_ss</code> implements a
similar approach which can be easily applied to published sets of GWAS
summary statistics without the requirement of access to original
individual-level data. The major advantage of our alternative suggested
method is the considerable improvement in computational efficiency, with
a reasonably low level of conceptual difficulty being
maintained.</p></li>
<li><p><code>BR_ss</code> takes a data frame <code>summary_data</code>
with three columns: <code>rsid</code>, <code>beta</code>,
<code>se</code>, and returns the inputted data frame along with the
adjusted estimate for <span class="math inline">\(\beta\)</span>,
<code>beta_BR_ss</code>. Note that all columns of the data frame,
<code>summary data</code> must contain numerical values, each row must
represent a unique SNP, identified by <code>rsid</code> and the function
requires that there must be at least 5 unique SNPs so that the smoothing
spline can be implemented successfully. The function also has a logical
parameter <code>seed_opt</code> which can be set to <code>TRUE</code> by
the user to permit reproducibility. Its default setting is
<code>seed_opt=FALSE</code>. As this method involves bootstrap
implementation, the use of a seed can allow the user to obtain the exact
same results for <code>beta_BR_ss</code> when running the function many
times on the same dataset. The parameter <code>seed</code> provides the
user with an option to set their desired value for the seed when using
<code>seed_opt=TRUE</code>. The default for <code>seed</code> is the
arbitrary value of <code>1998</code>.</p></li>
</ul>
<p><span class="math inline">\(~\)</span></p>
<p><strong>Method description:</strong></p>
<ul>
<li>
<p>This procedure begins with arranging all <span class="math inline">\(N\)</span> SNPs according to their original <span class="math inline">\(z\)</span>-statistics, <span class="math inline">\(z_i =
\frac{\hat\beta_i}{\hat{\text{se}(\hat\beta_i)}}\)</span>, in descending
order. A randomized estimate of the extent of ranking bias for the <span class="math inline">\(k^{th}\)</span> largest <span class="math inline">\(z\)</span>-statistic is calculated by means of the
parametric bootstrap as follows:</p>
<ol style="list-style-type: decimal">
<li><p>A value <span class="math inline">\(\hat\beta_i^{\text{b}}\)</span> is simulated for
SNP <span class="math inline">\(i, i=1,...,N\)</span>, independently,
from a Gaussian distribution with mean <span class="math inline">\(\hat\beta_i\)</span> and standard deviation <span class="math inline">\(\hat{\text{se}(\hat\beta_i)}\)</span>, i.e. <span class="math display">\[\hat\beta_i^{\text{b}} \sim N(\hat\beta_i,
\hat{\text{se}(\hat\beta_i)}).\]</span></p></li>
<li><p>Upon obtaining <span class="math inline">\(\hat\beta_i^{\text{b}}\)</span> for <span class="math inline">\(i, i=1,...,N\)</span>, the SNPs are subjected to
an ordering in which they are arranged based on their <span class="math inline">\(z_i^{\text{b}}\)</span>-statistics, in descending
order. The <span class="math inline">\(z_i^{\text{b}}\)</span>-statistic
of SNP <span class="math inline">\(i\)</span> is defined as <span class="math display">\[z_i^{\text{b}} =
\frac{\hat\beta_i^{\text{b}}}{\hat{\text{se}(\hat\beta_i)}}.\]</span>Due
to this ordering, each SNP is assigned a rank <span class="math inline">\(A(k)\)</span>. Equivalently, we define <span class="math inline">\(A(k)\)</span> as the index corresponding to the
<span class="math inline">\(k^{th}\)</span> largest entry in the vector:
<span class="math inline">\([z_1^{\text{b}}, ..., z_N^{\text{b}}] =
[\frac{\hat\beta_1^{\text{b}}}{\hat{\text{se}(\hat\beta_1)}}, ...,
\frac{\hat\beta_N^{\text{b}}}{\hat{\text{se}(\hat\beta_N)}}]\)</span>.</p></li>
<li><p>Then, the estimated bias of SNP <span class="math inline">\(k\)</span>, the SNP with the <span class="math inline">\(k^{th}\)</span> largest original <span class="math inline">\(z\)</span>-statistic, takes the following form:
<span class="math display">\[\text{bias}_k =
\frac{\hat\beta_{A(k)}^{\text{b}}-
\hat\beta_{A(k)}^{\text{oob}}}{\hat{\text{se}(\hat\beta_{A(k)})}} =
\frac{\hat\beta_{A(k)}^{\text{b}}-
\hat\beta_{A(k)}}{\hat{\text{se}(\hat\beta_{A(k)})}},\]</span>in which
<span class="math inline">\(\hat\beta_{A(k)}^{\text{b}}\)</span> is the
bootstrap value of the SNP ranked in position <span class="math inline">\(k\)</span> in the ordering of <span class="math inline">\(z_i^{\text{b}}\)</span>-statistics, <span class="math inline">\(\hat\beta_{A(k)}^{\text{oob}} =
\hat\beta_{A(k)}\)</span> is that same SNP’s original <span class="math inline">\(\beta\)</span> estimate and <span class="math inline">\(\hat{\text{se}(\hat\beta_{A(k)})}\)</span> its
standard error.</p></li>
</ol>
</li>
<li><p>In the next step of the process, a cubic smoothing spline is
fitted to the data in which the <span class="math inline">\(z\)</span>-statistics are considered as the inputs
and <span class="math inline">\(\text{bias}_k\)</span>, their
corresponding outputs. The predicted values from this model fitting
provides new estimates for the bias correction, <span class="math inline">\(\text{bias}_k^*\)</span> for each SNP. This
additional stage in which <span class="math inline">\(\text{bias}_k^*\)</span> is obtained eliminates
the need for more than one bootstrap iteration for each SNP in order to
ensure competitive performance of the method. This results in a faster
approach with increased accuracy.</p></li>
<li><p>Finally, the new estimate for the true effect size of SNP k, the
SNP with the kth largest original z-statistic, is defined as <span class="math inline">\(\hat\beta_k^* = \hat\beta_k -
\hat{\text{se}(\hat\beta_k)} \cdot \text{bias}_k^*\)</span>.</p></li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">out_BR_ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/BR_ss.html">BR_ss</a></span><span class="op">(</span>summary_data <span class="op">=</span> <span class="va">summary_stats</span>, seed<span class="op">=</span><span class="fl">2020</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">out_BR_ss</span><span class="op">)</span>
<span class="co">#&gt;   rsid        beta          se  beta_BR_ss</span>
<span class="co">#&gt; 1 3965  0.06064760 0.008191123  0.04959912</span>
<span class="co">#&gt; 2 7815  0.06273204 0.008477889  0.05128017</span>
<span class="co">#&gt; 3 4998 -0.05956742 0.008336576 -0.04600100</span>
<span class="co">#&gt; 4 7261  0.05510736 0.008186396  0.04168222</span>
<span class="co">#&gt; 5 6510  0.05623389 0.008389116  0.04237417</span>
<span class="co">#&gt; 6 9917  0.05466029 0.008176299  0.04108921</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="comparing-results">Comparing Results<a class="anchor" aria-label="anchor" href="#comparing-results"></a>
</h3>
<p>As we have simulated our data set, we have the ability to quantify
the amount of bias present in the original naive <span class="math inline">\(\beta\)</span> estimates and also, in our adjusted
estimates for each method. We can use measures such as the sum of
squared differences (<code>sq_diff</code>) and mean of absolute
differences (<code>mean_abs_diff</code>) to assess this bias.
Furthermore, we can also simply obtain the fraction of SNPs which are
now <em>less</em> biased after adjustment (<code>frac_less_bias</code>).
These three evaluation metrics can be be mathematically defined as
follows, in which there are <span class="math inline">\(n\)</span>
significant SNPs:</p>
<ul>
<li>
<code>sq_diff</code> <span class="math inline">\(= \sum_{i=1}^n
(\beta_i - \hat\beta_{\text{adj},i})^2\)</span>
</li>
<li>
<code>mean_abs_diff</code> <span class="math inline">\(= \frac{1}{n}
\sum_{i=1}^n |\beta_i - \hat\beta_{\text{adj},i}|\)</span>
</li>
<li>
<code>frac_less_bias</code> <span class="math inline">\(=
\frac{1}{n} \sum_{i=1}^n \text{I} \{ |\beta_i - \hat\beta_{i}| \gt
|\beta_i - \hat\beta_{\text{adj},i}| \}\)</span>
</li>
</ul>
<p>First, we take a look at the conditional likelihood method as
follows, in which only SNPs that are originally deemed significant are
included:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sq_diff_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>naive <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_CL</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, beta.cl1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_CL</span><span class="op">$</span><span class="va">beta.cl1</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,  beta.cl2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_CL</span><span class="op">$</span><span class="va">beta.cl2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,  beta.cl3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_CL</span><span class="op">$</span><span class="va">beta.cl3</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="va">sq_diff_1</span>
<span class="co">#&gt;        naive   beta.cl1    beta.cl2   beta.cl3</span>
<span class="co">#&gt; 1 0.01315265 0.01096133 0.004872073 0.00726706</span>

<span class="va">mean_abs_diff_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>naive <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_CL</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span><span class="op">)</span>, beta.cl1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_CL</span><span class="op">$</span><span class="va">beta.cl1</span><span class="op">)</span><span class="op">)</span>,  beta.cl2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_CL</span><span class="op">$</span><span class="va">beta.cl2</span><span class="op">)</span><span class="op">)</span>,  beta.cl3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_CL</span><span class="op">$</span><span class="va">beta.cl3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">mean_abs_diff_1</span>
<span class="co">#&gt;        naive   beta.cl1    beta.cl2   beta.cl3</span>
<span class="co">#&gt; 1 0.01655319 0.01495558 0.009610264 0.01212566</span>

<span class="va">frac_less_bias_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>beta.cl1 <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_CL</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_CL</span><span class="op">$</span><span class="va">beta.cl1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">out_CL</span><span class="op">)</span>, beta.cl2 <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_CL</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_CL</span><span class="op">$</span><span class="va">beta.cl2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">out_CL</span><span class="op">)</span>, beta.cl3 <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_CL</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_CL</span><span class="op">$</span><span class="va">beta.cl3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">out_CL</span><span class="op">)</span><span class="op">)</span>
<span class="va">frac_less_bias_1</span>
<span class="co">#&gt;    beta.cl1  beta.cl2  beta.cl3</span>
<span class="co">#&gt; 1 0.6176471 0.8235294 0.7352941</span></code></pre></div>
<p>For the first two quantities, the values for all three conditional
likelihood methods are less than that of the naive estimate and we find
that at least 62% of the significant SNPs are now less biased.</p>
<p>Next, we investigate the other three methods described above which
take into account all SNPs, not just those with <span class="math inline">\(p\)</span>-values less than a specified threshold.
Thus, when computing the values below, <span class="math inline">\(n\)</span> is now equal to the total number of
SNPs, i.e. <span class="math inline">\(n = 1,000,000\)</span>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sq_diff_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>naive <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_EB</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_EB</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, beta_EB <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_EB</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_EB</span><span class="op">$</span><span class="va">beta_EB</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, beta_FIQT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_FIQT</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_FIQT</span><span class="op">$</span><span class="va">beta_FIQT</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, beta_BR_ss <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_BR_ss</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_BR_ss</span><span class="op">$</span><span class="va">beta_BR_ss</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="va">sq_diff_2</span>
<span class="co">#&gt;      naive  beta_EB beta_FIQT beta_BR_ss</span>
<span class="co">#&gt; 1 155.8238 1.840651  1.867272   15.13993</span>

<span class="va">mean_abs_diff_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>naive <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_EB</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_EB</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span><span class="op">)</span>, beta_EB <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_EB</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_EB</span><span class="op">$</span><span class="va">beta_EB</span><span class="op">)</span><span class="op">)</span>, beta_FIQT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_FIQT</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_FIQT</span><span class="op">$</span><span class="va">beta_FIQT</span><span class="op">)</span><span class="op">)</span>, beta_BR_ss <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_BR_ss</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_BR_ss</span><span class="op">$</span><span class="va">beta_BR_ss</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">mean_abs_diff_2</span>
<span class="co">#&gt;         naive      beta_EB    beta_FIQT  beta_BR_ss</span>
<span class="co">#&gt; 1 0.009104013 0.0002067548 0.0002557587 0.002778236</span>

<span class="va">frac_less_bias_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>beta_EB <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_EB</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_EB</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_EB</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_EB</span><span class="op">$</span><span class="va">beta_EB</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">out_EB</span><span class="op">)</span>, beta_FIQT <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_FIQT</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_FIQT</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_FIQT</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_FIQT</span><span class="op">$</span><span class="va">beta_FIQT</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">out_FIQT</span><span class="op">)</span>, beta_BR_ss <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_BR_ss</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_BR_ss</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_BR_ss</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_BR_ss</span><span class="op">$</span><span class="va">beta_BR_ss</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">out_BR_ss</span><span class="op">)</span><span class="op">)</span>
<span class="va">frac_less_bias_2</span>
<span class="co">#&gt;    beta_EB beta_FIQT beta_BR_ss</span>
<span class="co">#&gt; 1 0.991785  0.994367   0.994128</span></code></pre></div>
<p>Again, we see that in the top two cases, the value associated with
the naive estimate is greatest. This assures us that the new adjusted
estimates provided by each method are indeed less biased than the
original <span class="math inline">\(\beta\)</span> estimate. In fact,
for each method, at least 99% of the association estimates of all SNPs
are now less biased.</p>
<p>Finally, we can compare the performance of all methods for the SNPs
with raw <span class="math inline">\(p\)</span>-values less than
<code>5e-8</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">out_EB_sig</span> <span class="op">&lt;-</span> <span class="va">out_EB</span><span class="op">[</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">out_EB</span><span class="op">$</span><span class="va">beta</span><span class="op">/</span><span class="va">out_EB</span><span class="op">$</span><span class="va">se</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">5e-8</span>,<span class="op">]</span>
<span class="va">out_FIQT_sig</span> <span class="op">&lt;-</span> <span class="va">out_FIQT</span><span class="op">[</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">out_FIQT</span><span class="op">$</span><span class="va">beta</span><span class="op">/</span><span class="va">out_FIQT</span><span class="op">$</span><span class="va">se</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">5e-8</span>,<span class="op">]</span>
<span class="va">out_BR_ss_sig</span> <span class="op">&lt;-</span> <span class="va">out_BR_ss</span><span class="op">[</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">out_BR_ss</span><span class="op">$</span><span class="va">beta</span><span class="op">/</span><span class="va">out_BR_ss</span><span class="op">$</span><span class="va">se</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">5e-8</span>,<span class="op">]</span>

<span class="va">sq_diff_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>naive <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_CL</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, beta.cl1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_CL</span><span class="op">$</span><span class="va">beta.cl1</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,  beta.cl2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_CL</span><span class="op">$</span><span class="va">beta.cl2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,  beta.cl3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_CL</span><span class="op">$</span><span class="va">beta.cl3</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, beta_EB <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_EB_sig</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_EB_sig</span><span class="op">$</span><span class="va">beta_EB</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, beta_FIQT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_FIQT_sig</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_FIQT_sig</span><span class="op">$</span><span class="va">beta_FIQT</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, beta_BR_ss <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_BR_ss_sig</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_BR_ss_sig</span><span class="op">$</span><span class="va">beta_BR_ss</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="va">sq_diff_3</span>
<span class="co">#&gt;        naive   beta.cl1    beta.cl2   beta.cl3     beta_EB   beta_FIQT</span>
<span class="co">#&gt; 1 0.01315265 0.01096133 0.004872073 0.00726706 0.005337383 0.003633531</span>
<span class="co">#&gt;    beta_BR_ss</span>
<span class="co">#&gt; 1 0.003402189</span>

<span class="va">mean_abs_diff_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>naive <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_CL</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span><span class="op">)</span>, beta.cl1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_CL</span><span class="op">$</span><span class="va">beta.cl1</span><span class="op">)</span><span class="op">)</span>,  beta.cl2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_CL</span><span class="op">$</span><span class="va">beta.cl2</span><span class="op">)</span><span class="op">)</span>,  beta.cl3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_CL</span><span class="op">$</span><span class="va">beta.cl3</span><span class="op">)</span><span class="op">)</span>, beta_EB <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_EB_sig</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_EB_sig</span><span class="op">$</span><span class="va">beta_EB</span><span class="op">)</span><span class="op">)</span>, beta_FIQT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_FIQT_sig</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_FIQT_sig</span><span class="op">$</span><span class="va">beta_FIQT</span><span class="op">)</span><span class="op">)</span>, beta_BR_ss <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_BR_ss_sig</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_BR_ss_sig</span><span class="op">$</span><span class="va">beta_BR_ss</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">mean_abs_diff_3</span>
<span class="co">#&gt;        naive   beta.cl1    beta.cl2   beta.cl3     beta_EB   beta_FIQT</span>
<span class="co">#&gt; 1 0.01655319 0.01495558 0.009610264 0.01212566 0.009245785 0.007019747</span>
<span class="co">#&gt;    beta_BR_ss</span>
<span class="co">#&gt; 1 0.006709485</span>

<span class="va">frac_less_bias_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>beta.cl1 <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_CL</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_CL</span><span class="op">$</span><span class="va">beta.cl1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">out_CL</span><span class="op">)</span>, beta.cl2 <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_CL</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_CL</span><span class="op">$</span><span class="va">beta.cl2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">out_CL</span><span class="op">)</span>, beta.cl3 <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_CL</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_CL</span><span class="op">$</span><span class="va">beta.cl3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">out_CL</span><span class="op">)</span>, beta_EB <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_EB_sig</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_EB_sig</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_EB_sig</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_EB_sig</span><span class="op">$</span><span class="va">beta_EB</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">out_EB_sig</span><span class="op">)</span>, beta_FIQT <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_FIQT_sig</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_FIQT_sig</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_FIQT_sig</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_FIQT_sig</span><span class="op">$</span><span class="va">beta_FIQT</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">out_FIQT_sig</span><span class="op">)</span>, beta_BR_ss <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_BR_ss_sig</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_BR_ss_sig</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_BR_ss_sig</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span> <span class="op">-</span> <span class="va">out_BR_ss_sig</span><span class="op">$</span><span class="va">beta_BR_ss</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">out_BR_ss_sig</span><span class="op">)</span><span class="op">)</span>
<span class="va">frac_less_bias_3</span>
<span class="co">#&gt;    beta.cl1  beta.cl2  beta.cl3   beta_EB beta_FIQT beta_BR_ss</span>
<span class="co">#&gt; 1 0.6176471 0.8235294 0.7352941 0.8823529 0.8529412  0.8529412</span></code></pre></div>
<p><span class="math inline">\(~\)</span> <span class="math inline">\(~\)</span></p>
<p>In addition, we can gain a visual insight into the adjustments made
by these functions by plotting the adjusted <em>absolute</em> values
along with the naive estimates and the true <em>absolute</em> <span class="math inline">\(\beta\)</span> values of SNPs which are originally
deemed as significant, i.e. those with raw <span class="math inline">\(p\)</span>-values less than <code>5e-8</code>, as
follows:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"RColorBrewer"</span><span class="op">)</span>
<span class="va">col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">8</span>,<span class="st">"Dark2"</span><span class="op">)</span>
  
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">out_EB_sig</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span><span class="op">)</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">80</span><span class="op">)</span>,xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.01</span>,<span class="fl">0.09</span><span class="op">)</span>,main<span class="op">=</span><span class="st">"Comparing Winner's Curse Methods"</span>,col<span class="op">=</span><span class="va">col</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,col<span class="op">=</span><span class="va">col</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">out_FIQT_sig</span><span class="op">$</span><span class="va">beta_FIQT</span><span class="op">)</span><span class="op">)</span>,col<span class="op">=</span><span class="va">col</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">out_CL</span><span class="op">$</span><span class="va">beta.cl1</span><span class="op">)</span><span class="op">)</span>,col<span class="op">=</span><span class="va">col</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">out_CL</span><span class="op">$</span><span class="va">beta.cl2</span><span class="op">)</span><span class="op">)</span>,col<span class="op">=</span><span class="va">col</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>,lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">out_CL</span><span class="op">$</span><span class="va">beta.cl3</span><span class="op">)</span><span class="op">)</span>,col<span class="op">=</span><span class="va">col</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span>,lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">out_EB_sig</span><span class="op">$</span><span class="va">beta_EB</span><span class="op">)</span><span class="op">)</span>,col<span class="op">=</span><span class="va">col</span><span class="op">[</span><span class="fl">7</span><span class="op">]</span>,lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">out_BR_ss_sig</span><span class="op">$</span><span class="va">beta_BR_ss</span><span class="op">)</span><span class="op">)</span>,col<span class="op">=</span><span class="va">col</span><span class="op">[</span><span class="fl">8</span><span class="op">]</span>,lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.008</span>, <span class="fl">77.5</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"beta_naive"</span>, <span class="st">"true_beta"</span>,<span class="st">"beta_FIQT"</span>,<span class="st">"beta.cl1"</span>,<span class="st">"beta.cl2"</span>,<span class="st">"beta.cl3"</span>,<span class="st">"beta_EB"</span>, <span class="st">"beta_BR_ss"</span><span class="op">)</span>,
       col<span class="op">=</span><span class="va">col</span>,lty<span class="op">=</span><span class="fl">1</span>,lwd<span class="op">=</span><span class="fl">2</span>,cex<span class="op">=</span><span class="fl">0.75</span><span class="op">)</span></code></pre></div>
<p><img src="winners_curse_methods_files/figure-html/unnamed-chunk-10-1.png" width="624"></p>
<p><span class="math inline">\(~\)</span> <span class="math inline">\(~\)</span></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Amanda Forde.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
