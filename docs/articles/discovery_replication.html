<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Methods for use with discovery and replication GWASs • winnerscurse</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Methods for use with discovery and replication GWASs">
<meta property="og:description" content="winnerscurse">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">winnerscurse</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/amandaforde/winners_curse" class="external-link">Source</a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Methods for use with discovery and replication
GWASs</h1>
            
      
      
      <div class="hidden name"><code>discovery_replication.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://amandaforde.github.io/winnerscurse/" class="external-link">winnerscurse</a></span><span class="op">)</span></span></code></pre></div>
<p>Our R package, <code>winnerscurse</code>, also contains several
functions which have the ability to obtain more accurate SNP-trait
association estimates when the summary statistics from two genetic
association studies, namely the discovery and replication GWASs, are
available. Thus, this second vignette demonstrates how the package can
be used to obtain new adjusted association estimates for each SNP using
these two data sets. Similar to the <a href="https://amandaforde.github.io/winnerscurse/articles/winners_curse_methods.html" class="external-link">first
vignette</a> which focused on <em>‘discovery only’</em> methods, we
first use the function <code>sim_stats</code> to create two toy data
sets and then, illustrate how a user may employ the package’s functions
to adjust for the bias imposed by winner’s curse.</p>
<p>The methods that are currently available for implementation
include:</p>
<ol style="list-style-type: decimal">
<li>Conditional Likelihood method - adapted from <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2536726/" class="external-link">Zhong and
Prentice (2008)</a>
</li>
<li>UMVCUE method - <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2726957/" class="external-link">Bowden and
Dudbridge (2009)</a>
</li>
</ol>
<p>It is important to note that with both of these methods, adjustments
are only made to SNPs that are deemed significant in the discovery data
set, i.e. the <span class="math inline">\(p\)</span>-values in the
discovery data set of these SNPs are less than that of the specified
threshold, <span class="math inline">\(\alpha\)</span>.</p>
<p>A third method has also been added which obtains a new association
estimate for each significant SNP in the discovery data set using a
combination of the discovery and replication estimates:</p>
<ol start="3" style="list-style-type: decimal">
<li>MSE minimization method - based on <a href="https://pubmed.ncbi.nlm.nih.gov/28745132/" class="external-link">Ferguson et
al. (2017)</a>
</li>
</ol>
<div class="section level3">
<h3 id="creating-two-toy-data-sets">Creating two toy data sets<a class="anchor" aria-label="anchor" href="#creating-two-toy-data-sets"></a>
</h3>
<ul>
<li><p>The function <code>sim_stats</code> allows users to simulate two
data sets of GWAS summary statistics which are based on the same true
underlying SNP-trait association values. This provides users with
simulated discovery and replication GWAS summary statistics to which the
aforementioned correction methods can then be applied.</p></li>
<li><p>When considering obtaining a simulated set of summary statistics
for both discovery and replication GWASs, <code>sim_stats</code>
requires the user to specify <strong>six</strong> arguments, namely
<code>nsnp</code>, <code>h2</code>, <code>prop_effect</code>,
<code>nid</code>, <code>rep</code> and <code>rep_nid</code>. The first
four arguments are defined just as in the first vignette, while
<code>rep</code> and <code>rep_nid</code> are defined as
follows:</p></li>
</ul>
<ol style="list-style-type: decimal">
<li>
<code>rep</code>: a logical parameter, i.e. <code>TRUE</code> or
<code>FALSE</code>, which allows the user to specify if they wish to
simulate summary statistics for a replication GWAS as well</li>
<li>
<code>rep_nid</code>: the number of samples in the replication
study</li>
</ol>
<ul>
<li><p>In order to obtain summary statistics for a replication GWAS, the
user must change <code>rep</code> from its default setting of
<code>rep=FALSE</code> to <code>rep=TRUE</code>. It is noted that the
default value for <code>rep_nid</code> is <code>rep_nid=50000</code>.
Thus, if the default values are used in <code>sim_stats</code> for every
argument except <code>rep</code>, two sets of summary statistics will be
simulated for 1,000,000 independent SNPs in which 1% have a true effect
on this trait with moderate heritability and a total of 50,000
individuals have been sampled in both the discovery and replication
studies.</p></li>
<li><p>As mentioned in the first vignette, <code>sim_stats</code>
outputs a list with three components, <code>true</code>,
<code>disc</code> and <code>rep</code>. When both discovery and
replication GWASs are considered and the function parameter
<code>rep</code> has been set to <code>TRUE</code>, the third element of
this list will no longer be <code>NULL</code>. Instead, a data frame
with three columns is outputted. Similar to <code>disc</code>, for each
SNP, the <code>rep</code> data frame contains its ID number, its
estimated effect size obtained in this replication study and associated
standard error. We again note that this function outputs both sets of
summary statistics in a suitable way so that the winner’s curse
correction methods can be directly applied, i.e. in the form of a
<strong>data frame with three columns <code>rsid</code>,
<code>beta</code> and <code>se</code></strong>.</p></li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1998</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim_dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_stats.html">sim_stats</a></span><span class="op">(</span>nsnp<span class="op">=</span><span class="fl">10</span><span class="op">^</span><span class="fl">6</span>,h2<span class="op">=</span><span class="fl">0.4</span>,prop_effect<span class="op">=</span><span class="fl">0.01</span>,nid<span class="op">=</span><span class="fl">50000</span>,rep<span class="op">=</span><span class="cn">TRUE</span>,rep_nid<span class="op">=</span><span class="fl">50000</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## simulated discovery GWAS summary statistics</span></span>
<span><span class="va">disc_stats</span> <span class="op">&lt;-</span> <span class="va">sim_dataset</span><span class="op">$</span><span class="va">disc</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">disc_stats</span><span class="op">)</span></span>
<span><span class="co">#&gt;   rsid         beta          se</span></span>
<span><span class="co">#&gt; 1    1 -0.013919699 0.019222524</span></span>
<span><span class="co">#&gt; 2    2  0.003097741 0.009187098</span></span>
<span><span class="co">#&gt; 3    3 -0.037870279 0.016459187</span></span>
<span><span class="co">#&gt; 4    4 -0.011874324 0.019560506</span></span>
<span><span class="co">#&gt; 5    5  0.024414134 0.006334964</span></span>
<span><span class="co">#&gt; 6    6 -0.001690693 0.007697227</span></span>
<span></span>
<span><span class="co">## simulated replication GWAS summary statistics</span></span>
<span><span class="va">rep_stats</span> <span class="op">&lt;-</span> <span class="va">sim_dataset</span><span class="op">$</span><span class="va">rep</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rep_stats</span><span class="op">)</span></span>
<span><span class="co">#&gt;   rsid         beta          se</span></span>
<span><span class="co">#&gt; 1    1 -0.022445150 0.019222524</span></span>
<span><span class="co">#&gt; 2    2  0.009001205 0.009187098</span></span>
<span><span class="co">#&gt; 3    3 -0.018269267 0.016459187</span></span>
<span><span class="co">#&gt; 4    4 -0.018674960 0.019560506</span></span>
<span><span class="co">#&gt; 5    5  0.031778103 0.006334964</span></span>
<span><span class="co">#&gt; 6    6  0.002267041 0.007697227</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="method-1-conditional-likelihood">Method 1: Conditional Likelihood<a class="anchor" aria-label="anchor" href="#method-1-conditional-likelihood"></a>
</h3>
<ul>
<li><p>The function <code>condlike_rep</code> implements a version of
the conditional likelihood method for obtaining bias-reduced association
estimates described in <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2536726/" class="external-link">Zhong and
Prentice (2008)</a>.</p></li>
<li><p>The function requires as inputs two independent data sets, one
representing a discovery GWAS, <code>summary_disc</code>, and the other
a replication study with identical SNPs, <code>summary_rep</code>, as
well as a specification of the significance threshold,
<code>alpha</code>, to be used. As before, the data sets must be in the
form of data frames with columns <code>rsid</code>, <code>beta</code>
and <code>se</code>, all columns of the data frames must contain
numerical values and each row of both data frames must represent a
unique SNP, identified by <code>rsid</code>. SNPs must be in the exact
same order in both data sets, i.e. the identity
<code>summary_rep$rsid == summary_disc$rsid</code> must evaluate to
<code>TRUE</code>.</p></li>
<li><p>Furthermore, the parameter <code>conf_interval</code> in
<code>condlike_rep</code> provides the user with the option to obtain
confidence intervals for each of the adjusted association estimates. The
default setting is <code>conf_interval=FALSE</code>. Inserting
<code>conf_interval=TRUE</code> when using the function will return
three sets of lower and upper confidence interval boundaries for each
SNP, each set corresponding to a particular form of adjusted estimate.
The final parameter <code>conf_level</code> takes a numerical value
between 0 and 1 which specifies the confidence interval, with the
default being <code>0.95</code>.</p></li>
<li><p>In a similar manner to other functions included in the package,
<code>condlike_rep</code> returns a single data frame with SNPs
reordered based on significance. However, it only contains SNPs which
have been deemed significant in the discovery data set. The first 5
columns of the data frame details the inputted information;
<code>rsid</code>, <code>beta_disc</code>, <code>se_disc</code>,
<code>beta_rep</code>, <code>se_rep</code>. Following this,
<code>beta_com</code> is the inverse variance weighted estimate which is
formally defined as:<span class="math display">\[\hat\beta_{\text{com}}
= \frac{\sigma_2^2 \hat\beta_1 + \sigma_1^2 \hat\beta_2}{\sigma_1^2 +
\sigma_2^2},\]</span> in which <span class="math inline">\(\hat\beta_1\)</span> = <code>beta_disc</code>,
<span class="math inline">\(\hat\beta_2\)</span> =
<code>beta_rep</code>, <span class="math inline">\(\sigma_1\)</span> =
<code>se_disc</code> and <span class="math inline">\(\sigma_2\)</span> =
<code>se_rep</code>.</p></li>
<li><p>The method implemented here uses just one selection cut-point at
the first discovery stage as opposed to that described in <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2536726/" class="external-link">Zhong and
Prentice (2008)</a> in which two separate selection thresholds are used.
Thus, the maximum likelihood adjusted estimator, <code>beta_MLE</code>
is defined to maximize the conditional likelihood at the observed <span class="math inline">\(\hat\beta_{\text{com}}\)</span>:<span class="math display">\[\hat\beta_{\text{MLE}} = \arg \max_{\beta} \log
f(\hat\beta_{\text{com}}; \beta).\]</span> The conditional sampling
distribution, <span class="math inline">\(f(x;\beta)\)</span> is
approximated by: <span class="math display">\[f(x;\beta) =
\frac{\frac{1}{\sigma_{\text{com}}}
\phi\left(\frac{x-\beta}{\sigma_{\text{com}}}\right) \cdot
\left[\Phi\left(\frac{x-c\sigma_1}{\frac{\sigma_1}{\sigma_2}\sigma_{\text{com}}}\right)
+
\Phi\left(\frac{-x-c\sigma_1}{\frac{\sigma_1}{\sigma_2}\sigma_{\text{com}}}\right)\right]}{\Phi\left(\frac{\beta}{\sigma_1}
- c\right) + \Phi\left(- \frac{\beta}{\sigma_1} -
c\right)}.\]</span></p></li>
<li><p><span class="math inline">\(c\)</span> is the selection
cut-point, i.e. all SNPs with <span class="math inline">\(\mid
\frac{\hat\beta_1}{\sigma_1}\mid \ge c\)</span> are deemed as
significant. The value of <span class="math inline">\(c\)</span> is
easily obtained using the chosen <code>alpha</code>. In addition, <span class="math display">\[\sigma^2_{\text{com}} = \frac{\sigma_1^2
\sigma_2^2}{\sigma_1^2 + \sigma_2^2}.\]</span></p></li>
<li><p>Note that this function, <span class="math inline">\(f(x;\beta)\)</span> is slightly different from
that given in the paper as only one selection cut-point is imposed
here.</p></li>
<li><p>Finally, Zhong and Prentice (2008) noted that simulation studies
showed that <span class="math inline">\(\hat\beta_{\text{com}}\)</span>
tended to have upward bias while <span class="math inline">\(\hat\beta_{\text{MLE}}\)</span> over-corrected and
therefore, a combination of the two in the following form was proposed:
<span class="math display">\[\hat\beta_{\text{MSE}} =
\frac{\hat\sigma^2_{\text{com}}\cdot \hat\beta_{\text{com}} +
(\hat\beta_{\text{com}} -
\hat\beta_{\text{MLE}})^2\cdot\hat\beta_{\text{MLE}}}{\sigma^2_{\text{com}}+(\hat\beta_{\text{com}}
- \hat\beta_{\text{MLE}})^2}.\]</span> This <span class="math inline">\(\hat\beta_{\text{MSE}}\)</span> holds the final
column of the outputted data frame in the default setting.</p></li>
<li><p>The use of <code>condlike_rep</code> with our toy data sets in
which <code>conf_interval=FALSE</code> is demonstrated below, with a
significance threshold value of <code>5e-8</code>:</p></li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_CL</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/condlike_rep.html">condlike_rep</a></span><span class="op">(</span>summary_disc<span class="op">=</span><span class="va">disc_stats</span>, summary_rep<span class="op">=</span><span class="va">rep_stats</span>, alpha<span class="op">=</span><span class="fl">5e-8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">out_CL</span><span class="op">)</span></span>
<span><span class="co">#&gt;   rsid   beta_disc     se_disc    beta_rep      se_rep    beta_com    beta_MLE</span></span>
<span><span class="co">#&gt; 1 3965  0.05013020 0.006345754  0.04754268 0.006345754  0.04883644  0.04874015</span></span>
<span><span class="co">#&gt; 2 7815  0.05040019 0.006567997  0.03849648 0.006567997  0.04444834  0.04374594</span></span>
<span><span class="co">#&gt; 3 4998 -0.04856148 0.006458450 -0.04232183 0.006458450 -0.04544166 -0.04501175</span></span>
<span><span class="co">#&gt; 4 7261  0.04649358 0.006342549  0.04167160 0.006342549  0.04408259  0.04358624</span></span>
<span><span class="co">#&gt; 5 6510  0.04611661 0.006499584  0.04135877 0.006499584  0.04373769  0.04299534</span></span>
<span><span class="co">#&gt; 6 9917  0.04489474 0.006333883  0.04504234 0.006333883  0.04496854  0.04459625</span></span>
<span><span class="co">#&gt;      beta_MSE</span></span>
<span><span class="co">#&gt; 1  0.04883640</span></span>
<span><span class="co">#&gt; 2  0.04443263</span></span>
<span><span class="co">#&gt; 3 -0.04543788</span></span>
<span><span class="co">#&gt; 4  0.04407658</span></span>
<span><span class="co">#&gt; 5  0.04371881</span></span>
<span><span class="co">#&gt; 6  0.04496598</span></span></code></pre></div>
<p><span class="math inline">\(~\)</span></p>
<p><strong>Confidence intervals:</strong></p>
<ul>
<li><p>Firstly, the <span class="math inline">\((1-\alpha)\%\)</span>
confidence interval for <span class="math inline">\(\hat\beta_{\text{com}}\)</span> is simply
calculated as: <span class="math display">\[\hat\beta_{\text{com}} \pm
\hat\sigma_{\text{com}}Z_{1-\frac{\alpha}{2}}.\]</span>For <span class="math inline">\(\hat\beta_{\text{MLE}}\)</span>, the profile
confidence limits are the intersection of the log-likelihood curve with
a horizontal line <span class="math inline">\(\frac{\chi^2_{1,1-\alpha}}{2}\)</span> units below
its maximum. The MSE weighting method, as described above, can then be
easily applied to the upper and lower boundaries of these two confidence
intervals to obtain an appropriate confidence interval for <span class="math inline">\(\hat\beta_{\text{MSE}}\)</span>. This gives: <span class="math display">\[\hat\beta_{\text{MSE};\frac{\alpha}{2}} =
\hat{K}_{\frac{\alpha}{2}} \hat\beta_{\text{com};\frac{\alpha}{2}} +
\left(1-\hat{K}_{\frac{\alpha}{2}}\right)
\hat\beta_{\text{MLE};\frac{\alpha}{2}}\]</span> <span class="math display">\[\hat\beta_{\text{MSE};1-\frac{\alpha}{2}} =
\hat{K}_{1-\frac{\alpha}{2}} \hat\beta_{\text{com};1-\frac{\alpha}{2}} +
\left(1-\hat{K}_{1-\frac{\alpha}{2}}\right)
\hat\beta_{\text{MLE};1-\frac{\alpha}{2}}\]</span> in which <span class="math inline">\(\hat{K}_{\frac{\alpha}{2}} =
\frac{\hat\sigma^2_{\text{com}}}{\hat\sigma^2_{\text{com}} +
\left(\hat\beta_{\text{com};\frac{\alpha}{2}} -
\hat\beta_{\text{MLE};\frac{\alpha}{2}}\right)^2} \;\)</span> and <span class="math inline">\(\; \hat{K}_{1-\frac{\alpha}{2}} =
\frac{\hat\sigma^2_{\text{com}}}{\hat\sigma^2_{\text{com}} +
\left(\hat\beta_{\text{com};1-\frac{\alpha}{2}} -
\hat\beta_{\text{MLE};1-\frac{\alpha}{2}}\right)^2}.\)</span></p></li>
<li><p>We implement <code>condlike_rep</code> on our toy data sets with
<code>conf_interval</code> now set to <code>TRUE</code> to show the form
in which the output now takes. A similar data frame to that above is
returned with 95% confidence intervals also included for each adjusted
association estimate for each SNP.</p></li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_CL_conf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/condlike_rep.html">condlike_rep</a></span><span class="op">(</span>summary_disc<span class="op">=</span><span class="va">disc_stats</span>, summary_rep<span class="op">=</span><span class="va">rep_stats</span>, alpha<span class="op">=</span><span class="fl">5e-8</span>, conf_interval<span class="op">=</span><span class="cn">TRUE</span>, conf_level<span class="op">=</span><span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">out_CL_conf</span><span class="op">)</span></span>
<span><span class="co">#&gt;   rsid   beta_disc     se_disc    beta_rep      se_rep    beta_com</span></span>
<span><span class="co">#&gt; 1 3965  0.05013020 0.006345754  0.04754268 0.006345754  0.04883644</span></span>
<span><span class="co">#&gt; 2 7815  0.05040019 0.006567997  0.03849648 0.006567997  0.04444834</span></span>
<span><span class="co">#&gt; 3 4998 -0.04856148 0.006458450 -0.04232183 0.006458450 -0.04544166</span></span>
<span><span class="co">#&gt; 4 7261  0.04649358 0.006342549  0.04167160 0.006342549  0.04408259</span></span>
<span><span class="co">#&gt; 5 6510  0.04611661 0.006499584  0.04135877 0.006499584  0.04373769</span></span>
<span><span class="co">#&gt; 6 9917  0.04489474 0.006333883  0.04504234 0.006333883  0.04496854</span></span>
<span><span class="co">#&gt;   beta_com_lower beta_com_upper    beta_MLE beta_MLE_lower beta_MLE_upper</span></span>
<span><span class="co">#&gt; 1     0.04004184     0.05763104  0.04874015     0.03952870     0.05760615</span></span>
<span><span class="co">#&gt; 2     0.03534572     0.05355095  0.04374594     0.03337042     0.05330180</span></span>
<span><span class="co">#&gt; 3    -0.05439245    -0.03649087 -0.04501175    -0.05425351    -0.03510238</span></span>
<span><span class="co">#&gt; 4     0.03529243     0.05287275  0.04358624     0.03377022     0.05270884</span></span>
<span><span class="co">#&gt; 5     0.03472989     0.05274549  0.04299534     0.03268562     0.05247975</span></span>
<span><span class="co">#&gt; 6     0.03619038     0.05374669  0.04459625     0.03493974     0.05362905</span></span>
<span><span class="co">#&gt;      beta_MSE beta_MSE_lower beta_MSE_upper</span></span>
<span><span class="co">#&gt; 1  0.04883640     0.04003521     0.05763104</span></span>
<span><span class="co">#&gt; 2  0.04443263     0.03504314     0.05355023</span></span>
<span><span class="co">#&gt; 3 -0.04543788    -0.05439232    -0.03637338</span></span>
<span><span class="co">#&gt; 4  0.04407658     0.03513518     0.05287253</span></span>
<span><span class="co">#&gt; 5  0.04371881     0.03439224     0.05274460</span></span>
<span><span class="co">#&gt; 6  0.04496598     0.03609992     0.05374661</span></span></code></pre></div>
<p><span style="color: blue;"><span class="math inline">\(\star\)</span></span> <strong>Note:</strong> As
the current form of <code>condlike_rep</code> uses the R function
<code>uniroot</code> which aims to find values for
<code>beta_MLE_lower</code> and <code>beta_MLE_upper</code> numerically,
it is possible that <code>uniroot</code> may fail to successfully
achieve this in some situations. We thus urge users to take care when
using <code>condlike_rep</code> to obtain confidence intervals and to be
mindful of this potential failure of <code>uniroot</code>.</p>
</div>
<div class="section level3">
<h3 id="method-2-umvcue">Method 2: UMVCUE<a class="anchor" aria-label="anchor" href="#method-2-umvcue"></a>
</h3>
<ul>
<li><p>The implementation of <code>UMVCUE</code> is very similar to the
function described above in the sense that <code>UMVCUE</code> requires
the same inputs; discovery and replication data sets in the form of
three-columned data frames together with a threshold value,
<code>alpha</code>. Furthermore, the outputted data frame is in the same
form with just one extra column providing the adjusted estimate,
<code>beta_UMVCUE</code>.</p></li>
<li><p>Selection also occurs here at just one stage as SNPs are deemed
as significant if their <span class="math inline">\(p\)</span>-values
corresponding to <span class="math inline">\(\mid
\frac{\hat\beta_1}{\sigma_1}\mid\)</span> are smaller than the given
threshold.</p></li>
<li><p>The function <code>UMVCUE</code> executes the method detailed in
<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2726957/" class="external-link">Bowden
and Dudbridge (2009)</a>. No adaptations have been made to the method
described.</p></li>
<li><p>It is worth noting that, as with all conditional likelihood
methods, the method used in <code>condlike_rep</code> makes adjustments
to each SNP one at a time with no information relating to other SNPs
required for this adjustment. However, after ordering SNPs based on
significance, for a single SNP, <code>UMVCUE</code> also uses the data
of SNPs on either side of it to assist with the adjustment.</p></li>
<li><p><code>UMVCUE</code> can be applied to the toy data sets as
followed, with <code>alpha</code> again specified as
<code>5e-8</code>:</p></li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_UMVCUE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/UMVCUE.html">UMVCUE</a></span><span class="op">(</span>summary_disc <span class="op">=</span> <span class="va">disc_stats</span>, summary_rep <span class="op">=</span> <span class="va">rep_stats</span>, alpha <span class="op">=</span> <span class="fl">5e-8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">out_UMVCUE</span><span class="op">)</span></span>
<span><span class="co">#&gt;   rsid   beta_disc     se_disc    beta_rep      se_rep beta_UMVCUE</span></span>
<span><span class="co">#&gt; 1 3965  0.05013020 0.006345754  0.04754268 0.006345754  0.04534592</span></span>
<span><span class="co">#&gt; 2 7815  0.05040019 0.006567997  0.03849648 0.006567997  0.03840796</span></span>
<span><span class="co">#&gt; 3 4998 -0.04856148 0.006458450 -0.04232183 0.006458450 -0.04249046</span></span>
<span><span class="co">#&gt; 4 7261  0.04649358 0.006342549  0.04167160 0.006342549  0.04188581</span></span>
<span><span class="co">#&gt; 5 6510  0.04611661 0.006499584  0.04135877 0.006499584  0.04064881</span></span>
<span><span class="co">#&gt; 6 9917  0.04489474 0.006333883  0.04504234 0.006333883  0.04545721</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="method-3-mse-minimization">Method 3: MSE minimization<a class="anchor" aria-label="anchor" href="#method-3-mse-minimization"></a>
</h3>
<ul>
<li><p>The function <code>MSE_minimizer</code> implements a combination
method which closely follows that described in <a href="https://pubmed.ncbi.nlm.nih.gov/28745132/" class="external-link">Ferguson <em>et
al.</em> (2017)</a>. The function parameters used here;
<code>summary_disc</code>, <code>summary_rep</code> and
<code>alpha</code>, are precisely of the same form as those previously
detailed in this vignette. In addition, <code>MSE_minimizer</code> has a
logical parameter, namely <code>spline</code> which defaults as
<code>spline=TRUE</code>. As a smoothing spline is used in the execution
of this function, data corresponding to at least 5 SNPs is
required.</p></li>
<li><p>An adjusted estimate is computed for each SNP which has been
classified as significant in the discovery data set, based on the given
threshold. Thus, similar to the above method, <code>MSE_minimizer</code>
returns a data frame containing these significant SNPs with 6 columns in
which the final column contains the new estimate,
<code>beta_joint</code>.</p></li>
<li><p>Following the approach detailed in <a href="https://pubmed.ncbi.nlm.nih.gov/28745132/" class="external-link">Ferguson <em>et
al.</em> (2017)</a>, we define the adjusted linear combination estimator
as: <span class="math display">\[\hat\beta_{\text{joint}} =
\omega(\hat{B}) \cdot \hat\beta_{\text{rep}} + (1-\omega(\hat{B}))\cdot
\hat\beta_{\text{disc}}\]</span> in which <span class="math display">\[
\omega(\hat{B}) =
\frac{\frac{1}{\sigma^2_{\text{rep}}}}{\frac{1}{\sigma^2_{\text{rep}}}+\frac{1}{\sigma^2_{\text{disc}}+
\hat{B}^2}}.\]</span> When <code>spline=FALSE</code> is used, we simply
let <span class="math inline">\(\hat{B} = \hat\beta_{\text{disc}} -
\hat\beta_{\text{rep}}\)</span>. We make the assumptions that <span class="math inline">\(\beta_{\text{rep}}\)</span> is unbiased for <span class="math inline">\(\beta\)</span>, but <span class="math inline">\(\beta_{\text{disc}}\)</span> is quite likely to be
biased and that <span class="math inline">\(\beta_{\text{rep}}\)</span>
and <span class="math inline">\(\beta_{\text{disc}}\)</span> are
independent.</p></li>
<li><p>For the default setting <code>spline=TRUE</code>, a cubic
smoothing spline is applied in which the values of <span class="math inline">\(z_{\text{disc}} =
\frac{\hat\beta_{\text{disc}}}{\sigma_{\text{disc}}}\)</span> are
considered as inputs and <span class="math inline">\(\hat{B} =
\hat\beta_{\text{disc}} - \hat\beta_{\text{rep}}\)</span>, the
corresponding outputs. The predicted values for <span class="math inline">\(\hat{B}\)</span> from this process, <span class="math inline">\(\hat{B}^*\)</span> say, are then used instead of
<span class="math inline">\(\hat{B}\)</span> when computing <span class="math inline">\(\hat\beta_{\text{joint}}\)</span> for each
SNP.</p></li>
<li><p>We apply <code>MSE_minimizer</code> to our toy data sets, once
with the default setting for <code>spline</code> and once with
<code>spline=FALSE</code>. Again for convenient demonstration purposes,
we specify the significance threshold as <code>5e-8</code>.</p></li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_minimizerA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MSE_minimizer.html">MSE_minimizer</a></span><span class="op">(</span>summary_disc <span class="op">=</span> <span class="va">disc_stats</span>, summary_rep <span class="op">=</span> <span class="va">rep_stats</span>, alpha<span class="op">=</span><span class="fl">5e-8</span>, spline<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">out_minimizerB</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MSE_minimizer.html">MSE_minimizer</a></span><span class="op">(</span>summary_disc <span class="op">=</span> <span class="va">disc_stats</span>, summary_rep <span class="op">=</span> <span class="va">rep_stats</span>, alpha<span class="op">=</span><span class="fl">5e-8</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">out_minimizerA</span><span class="op">)</span></span>
<span><span class="co">#&gt;   rsid   beta_disc     se_disc    beta_rep      se_rep  beta_joint</span></span>
<span><span class="co">#&gt; 1 3965  0.05013020 0.006345754  0.04754268 0.006345754  0.04873714</span></span>
<span><span class="co">#&gt; 2 7815  0.05040019 0.006567997  0.03849648 0.006567997  0.04074896</span></span>
<span><span class="co">#&gt; 3 4998 -0.04856148 0.006458450 -0.04232183 0.006458450 -0.04444894</span></span>
<span><span class="co">#&gt; 4 7261  0.04649358 0.006342549  0.04167160 0.006342549  0.04354204</span></span>
<span><span class="co">#&gt; 5 6510  0.04611661 0.006499584  0.04135877 0.006499584  0.04323500</span></span>
<span><span class="co">#&gt; 6 9917  0.04489474 0.006333883  0.04504234 0.006333883  0.04496856</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">out_minimizerB</span><span class="op">)</span></span>
<span><span class="co">#&gt;   rsid   beta_disc     se_disc    beta_rep      se_rep  beta_joint</span></span>
<span><span class="co">#&gt; 1 3965  0.05013020 0.006345754  0.04754268 0.006345754  0.04798402</span></span>
<span><span class="co">#&gt; 2 7815  0.05040019 0.006567997  0.03849648 0.006567997  0.04143473</span></span>
<span><span class="co">#&gt; 3 4998 -0.04856148 0.006458450 -0.04232183 0.006458450 -0.04280239</span></span>
<span><span class="co">#&gt; 4 7261  0.04649358 0.006342549  0.04167160 0.006342549  0.04330376</span></span>
<span><span class="co">#&gt; 5 6510  0.04611661 0.006499584  0.04135877 0.006499584  0.04321159</span></span>
<span><span class="co">#&gt; 6 9917  0.04489474 0.006333883  0.04504234 0.006333883  0.04498537</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="comparing-results">Comparing Results<a class="anchor" aria-label="anchor" href="#comparing-results"></a>
</h3>
<p>Just as in the first vignette, we can briefly compare the performance
of our correct methods using measures such as the estimated root mean
square error of significant SNPs (<code>rmse</code>) and the estimated
average bias over all significant SNPs (<code>bias</code>). The
significant SNPs we refer to here are those that have been deemed
significant at a threshold of <span class="math inline">\(\alpha=5
\times 10^{-8}\)</span> in the discovery GWAS.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Simulated true effect sizes:</span></span>
<span><span class="va">true_beta</span> <span class="op">&lt;-</span> <span class="va">sim_dataset</span><span class="op">$</span><span class="va">true</span><span class="op">$</span><span class="va">true_beta</span></span></code></pre></div>
<p>The estimated root mean square error of significant SNPs for each
method is computed below. It is clear that all methods show an
improvement on the estimates obtained from the discovery data set.
However, certain further investigation will be required in order to
evaluate if the adjusted estimates are less biased or more accurate than
the mere use of replication estimates.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## rmse</span></span>
<span><span class="va">rmse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>disc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">out_CL</span><span class="op">$</span><span class="va">beta_disc</span> <span class="op">-</span> <span class="va">true_beta</span><span class="op">[</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>, rep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">out_CL</span><span class="op">$</span><span class="va">beta_rep</span> <span class="op">-</span> <span class="va">true_beta</span><span class="op">[</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>, CL_com <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">out_CL</span><span class="op">$</span><span class="va">beta_com</span> <span class="op">-</span> <span class="va">true_beta</span><span class="op">[</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>, CL_MLE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">out_CL</span><span class="op">$</span><span class="va">beta_MLE</span> <span class="op">-</span> <span class="va">true_beta</span><span class="op">[</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>, CL_MSE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">out_CL</span><span class="op">$</span><span class="va">beta_MSE</span> <span class="op">-</span> <span class="va">true_beta</span><span class="op">[</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>, UMVCUE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">out_UMVCUE</span><span class="op">$</span><span class="va">beta_UMVCUE</span> <span class="op">-</span> <span class="va">true_beta</span><span class="op">[</span><span class="va">out_UMVCUE</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>, minimizerA <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">out_minimizerA</span><span class="op">$</span><span class="va">beta_joint</span> <span class="op">-</span> <span class="va">true_beta</span><span class="op">[</span><span class="va">out_minimizerA</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>, minimizerB <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">out_minimizerB</span><span class="op">$</span><span class="va">beta_joint</span> <span class="op">-</span> <span class="va">true_beta</span><span class="op">[</span><span class="va">out_minimizerB</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">rmse</span></span>
<span><span class="co">#&gt;         disc         rep      CL_com      CL_MLE      CL_MSE      UMVCUE</span></span>
<span><span class="co">#&gt; 1 0.01486281 0.006825705 0.008522003 0.006602122 0.006913343 0.006745814</span></span>
<span><span class="co">#&gt;    minimizerA  minimizerB</span></span>
<span><span class="co">#&gt; 1 0.006911017 0.007335226</span></span></code></pre></div>
<p>The next metric, the average bias over all significant SNPs with
positive association estimates, is included below.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## bias positive</span></span>
<span><span class="va">pos_sig</span> <span class="op">&lt;-</span> <span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span><span class="op">[</span><span class="va">out_CL</span><span class="op">$</span><span class="va">beta_disc</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">]</span></span>
<span><span class="va">pos_sigA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">pos_sig</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bias_up</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>disc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out_CL</span><span class="op">$</span><span class="va">beta_disc</span><span class="op">[</span><span class="va">pos_sigA</span><span class="op">]</span> <span class="op">-</span> <span class="va">true_beta</span><span class="op">[</span><span class="va">pos_sig</span><span class="op">]</span><span class="op">)</span>, rep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out_CL</span><span class="op">$</span><span class="va">beta_rep</span><span class="op">[</span><span class="va">pos_sigA</span><span class="op">]</span> <span class="op">-</span> <span class="va">true_beta</span><span class="op">[</span><span class="va">pos_sig</span><span class="op">]</span><span class="op">)</span>, CL_com <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out_CL</span><span class="op">$</span><span class="va">beta_com</span><span class="op">[</span><span class="va">pos_sigA</span><span class="op">]</span> <span class="op">-</span> <span class="va">true_beta</span><span class="op">[</span><span class="va">pos_sig</span><span class="op">]</span><span class="op">)</span>, CL_MLE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out_CL</span><span class="op">$</span><span class="va">beta_MLE</span><span class="op">[</span><span class="va">pos_sigA</span><span class="op">]</span> <span class="op">-</span> <span class="va">true_beta</span><span class="op">[</span><span class="va">pos_sig</span><span class="op">]</span><span class="op">)</span>, CL_MSE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out_CL</span><span class="op">$</span><span class="va">beta_MSE</span><span class="op">[</span><span class="va">pos_sigA</span><span class="op">]</span> <span class="op">-</span> <span class="va">true_beta</span><span class="op">[</span><span class="va">pos_sig</span><span class="op">]</span><span class="op">)</span>, UMVCUE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out_UMVCUE</span><span class="op">$</span><span class="va">beta_UMVCUE</span><span class="op">[</span><span class="va">pos_sigA</span><span class="op">]</span> <span class="op">-</span> <span class="va">true_beta</span><span class="op">[</span><span class="va">pos_sig</span><span class="op">]</span><span class="op">)</span>, minimizerA <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out_minimizerA</span><span class="op">$</span><span class="va">beta_joint</span><span class="op">[</span><span class="va">pos_sigA</span><span class="op">]</span> <span class="op">-</span> <span class="va">true_beta</span><span class="op">[</span><span class="va">pos_sig</span><span class="op">]</span><span class="op">)</span>, minimizerB <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out_minimizerB</span><span class="op">$</span><span class="va">beta_joint</span><span class="op">[</span><span class="va">pos_sigA</span><span class="op">]</span> <span class="op">-</span> <span class="va">true_beta</span><span class="op">[</span><span class="va">pos_sig</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bias_up</span></span>
<span><span class="co">#&gt;        disc           rep      CL_com       CL_MLE      CL_MSE       UMVCUE</span></span>
<span><span class="co">#&gt; 1 0.0126302 -0.0004286069 0.006100796 0.0006417358 0.001949358 -0.000652057</span></span>
<span><span class="co">#&gt;    minimizerA  minimizerB</span></span>
<span><span class="co">#&gt; 1 0.001104282 0.003867762</span></span></code></pre></div>
<p>In a similar manner, the average bias over all significant SNPs with
negative association estimates, is computed.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## bias negative</span></span>
<span><span class="va">neg_sig</span> <span class="op">&lt;-</span> <span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span><span class="op">[</span><span class="va">out_CL</span><span class="op">$</span><span class="va">beta_disc</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">]</span></span>
<span><span class="va">neg_sigA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">neg_sig</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bias_down</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>disc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out_CL</span><span class="op">$</span><span class="va">beta_disc</span><span class="op">[</span><span class="va">neg_sigA</span><span class="op">]</span> <span class="op">-</span> <span class="va">true_beta</span><span class="op">[</span><span class="va">neg_sig</span><span class="op">]</span><span class="op">)</span>, rep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out_CL</span><span class="op">$</span><span class="va">beta_rep</span><span class="op">[</span><span class="va">neg_sigA</span><span class="op">]</span> <span class="op">-</span> <span class="va">true_beta</span><span class="op">[</span><span class="va">neg_sig</span><span class="op">]</span><span class="op">)</span>, CL_com <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out_CL</span><span class="op">$</span><span class="va">beta_com</span><span class="op">[</span><span class="va">neg_sigA</span><span class="op">]</span> <span class="op">-</span> <span class="va">true_beta</span><span class="op">[</span><span class="va">neg_sig</span><span class="op">]</span><span class="op">)</span>, CL_MLE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out_CL</span><span class="op">$</span><span class="va">beta_MLE</span><span class="op">[</span><span class="va">neg_sigA</span><span class="op">]</span> <span class="op">-</span> <span class="va">true_beta</span><span class="op">[</span><span class="va">neg_sig</span><span class="op">]</span><span class="op">)</span>, CL_MSE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out_CL</span><span class="op">$</span><span class="va">beta_MSE</span><span class="op">[</span><span class="va">neg_sigA</span><span class="op">]</span> <span class="op">-</span> <span class="va">true_beta</span><span class="op">[</span><span class="va">neg_sig</span><span class="op">]</span><span class="op">)</span>, UMVCUE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out_UMVCUE</span><span class="op">$</span><span class="va">beta_UMVCUE</span><span class="op">[</span><span class="va">neg_sigA</span><span class="op">]</span> <span class="op">-</span> <span class="va">true_beta</span><span class="op">[</span><span class="va">neg_sig</span><span class="op">]</span><span class="op">)</span>, minimizerA <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out_minimizerA</span><span class="op">$</span><span class="va">beta_joint</span><span class="op">[</span><span class="va">neg_sigA</span><span class="op">]</span> <span class="op">-</span> <span class="va">true_beta</span><span class="op">[</span><span class="va">neg_sig</span><span class="op">]</span><span class="op">)</span>, minimizerB <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out_minimizerB</span><span class="op">$</span><span class="va">beta_joint</span><span class="op">[</span><span class="va">neg_sigA</span><span class="op">]</span> <span class="op">-</span> <span class="va">true_beta</span><span class="op">[</span><span class="va">neg_sig</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bias_down</span></span>
<span><span class="co">#&gt;          disc          rep       CL_com       CL_MLE       CL_MSE       UMVCUE</span></span>
<span><span class="co">#&gt; 1 -0.01172448 -0.001100763 -0.006412624 -0.001322764 -0.003147114 -0.001036073</span></span>
<span><span class="co">#&gt;     minimizerA   minimizerB</span></span>
<span><span class="co">#&gt; 1 -0.002856657 -0.005493027</span></span></code></pre></div>
<p>To complement the above, we provide an illustration of boxplots
obtained for the root mean square error of significant SNPs
(<strong>RMSE of sig. SNPs at <span class="math inline">\(5 \times
10^{-8}\)</span></strong>), plotted for each winner’s curse correction
method (<strong>Method</strong>).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">RColorBrewer</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="va">col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">8</span>,<span class="st">"Dark2"</span><span class="op">)</span></span>
<span><span class="va">col1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">11</span>,<span class="st">"RdYlBu"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">all_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>rsid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span>, beta_disc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">out_CL</span><span class="op">$</span><span class="va">beta_disc</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span>, se_disc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">out_CL</span><span class="op">$</span><span class="va">se_disc</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span>, adj_beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">out_CL</span><span class="op">$</span><span class="va">beta_disc</span>,<span class="va">out_CL</span><span class="op">$</span><span class="va">beta_rep</span>,<span class="va">out_CL</span><span class="op">$</span><span class="va">beta_com</span>,<span class="va">out_CL</span><span class="op">$</span><span class="va">beta_MLE</span>,<span class="va">out_CL</span><span class="op">$</span><span class="va">beta_MSE</span>,<span class="va">out_UMVCUE</span><span class="op">$</span><span class="va">beta_UMVCUE</span>,<span class="va">out_minimizerA</span><span class="op">$</span><span class="va">beta_joint</span>,<span class="va">out_minimizerB</span><span class="op">$</span><span class="va">beta_joint</span><span class="op">)</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"disc"</span>,<span class="fl">34</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"rep"</span>,<span class="fl">34</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"CL_com"</span>,<span class="fl">34</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"CL_MLE"</span>,<span class="fl">34</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"CL_MSE"</span>,<span class="fl">34</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"UMVCUE"</span>,<span class="fl">34</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"minimizerA"</span>,<span class="fl">34</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"minimizerB"</span>,<span class="fl">34</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">all_results</span><span class="op">$</span><span class="va">rmse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="va">all_results</span><span class="op">$</span><span class="va">adj_beta</span> <span class="op">-</span> <span class="va">true_beta</span><span class="op">[</span><span class="va">all_results</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">all_results</span><span class="op">$</span><span class="va">method</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">all_results</span><span class="op">$</span><span class="va">method</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"disc"</span>,<span class="st">"rep"</span>,<span class="st">"CL_com"</span>, <span class="st">"CL_MLE"</span>, <span class="st">"CL_MSE"</span>, <span class="st">"UMVCUE"</span>, <span class="st">"minimizerA"</span>, <span class="st">"minimizerB"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">all_results</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">method</span>,y<span class="op">=</span><span class="va">rmse</span>,fill<span class="op">=</span><span class="va">method</span>, color<span class="op">=</span><span class="va">method</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">0.7</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">method</span>, color<span class="op">=</span><span class="va">method</span>, alpha<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">col</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">7</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">8</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">col</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">7</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">8</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>  <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Method"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"RMSE of sig. SNPs at  "</span>, <span class="fl">5</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept<span class="op">=</span><span class="fl">0</span>, colour<span class="op">=</span><span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle<span class="op">=</span><span class="fl">90</span>, vjust<span class="op">=</span><span class="fl">0.5</span>, hjust<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">12</span><span class="op">)</span>,legend.position <span class="op">=</span> <span class="st">"none"</span>, strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face<span class="op">=</span><span class="st">"italic"</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p><img src="discovery_replication_files/figure-html/unnamed-chunk-11-1.png" width="624"></p>
<p>In addition, we can gain a visual insight into the adjustments made
by these functions by constructing a <strong>density</strong> plot with
the adjusted <em>absolute</em> values along with the naive estimates and
the true <em>absolute <span class="math inline">\(\beta\)</span></em>
values of significant SNPs, as follows:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">true</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>rsid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span><span class="op">)</span>, beta_disc <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">out_CL</span><span class="op">$</span><span class="va">beta_disc</span><span class="op">)</span>, se_disc <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">out_CL</span><span class="op">$</span><span class="va">se_disc</span><span class="op">)</span>,adj_beta<span class="op">=</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span>,method<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"true"</span>,<span class="fl">34</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">all_resultsA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">all_results</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,<span class="va">true</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">all_resultsA</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">adj_beta</span><span class="op">)</span>,colour<span class="op">=</span><span class="va">method</span>,fill<span class="op">=</span><span class="va">method</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">0.05</span>,size<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">col</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">7</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">8</span><span class="op">]</span>,<span class="va">col1</span><span class="op">[</span><span class="fl">11</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">col</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">7</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">8</span><span class="op">]</span>,<span class="va">col1</span><span class="op">[</span><span class="fl">11</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.01</span>,<span class="fl">0.08</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"|"</span>, <span class="va">beta</span>, <span class="st">"| "</span> , <span class="st">"of sig. SNPs at  "</span>, <span class="fl">5</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Method"</span>,colour<span class="op">=</span><span class="st">"Method"</span><span class="op">)</span></span></code></pre></div>
<p><img src="discovery_replication_files/figure-html/unnamed-chunk-12-1.png" width="624"></p>
<p><span style="color: blue;"><span class="math inline">\(\star\)</span></span> <strong>Note:</strong> In
the above plot, it can be seen that there must be very little difference
between the replication estimates and the adjusted estimates obtained
using the UMVCUE method as the density curves of <code>rep</code> and
<code>UMVCUE</code> can be seen to nearly overlap completely.</p>
<p><span class="math inline">\(~\)</span> <span class="math inline">\(~\)</span></p>
</div>
<div class="section level3">
<h3 id="using-empirical-bayes-and-bootstrap-methods-with-replication-data-sets">Using empirical Bayes and bootstrap methods with replication data
sets<a class="anchor" aria-label="anchor" href="#using-empirical-bayes-and-bootstrap-methods-with-replication-data-sets"></a>
</h3>
<p>When a replication data set is also available, as has been described
throughout this vignette, we also potentially have the option to employ
the empirical Bayes and bootstrap methods. We have seen this work well
in simulations, especially in terms of reducing the mean square error
(MSE) and thus, consider exploration of their implementation in this
setting. With data in the form described above similar to
<code>disc_stats</code> and <code>rep_stats</code>, implementation of
both methods could take place on the combined estimator as shown
below:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## combined estimator:</span></span>
<span><span class="va">com_stats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>rsid <span class="op">=</span> <span class="va">disc_stats</span><span class="op">$</span><span class="va">rsid</span>, beta <span class="op">=</span> <span class="op">(</span><span class="op">(</span><span class="op">(</span><span class="op">(</span><span class="va">rep_stats</span><span class="op">$</span><span class="va">se</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">disc_stats</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="op">(</span><span class="op">(</span><span class="op">(</span><span class="va">disc_stats</span><span class="op">$</span><span class="va">se</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">rep_stats</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="op">(</span><span class="op">(</span><span class="va">disc_stats</span><span class="op">$</span><span class="va">se</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="op">(</span><span class="va">rep_stats</span><span class="op">$</span><span class="va">se</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>, se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="op">(</span><span class="op">(</span><span class="va">disc_stats</span><span class="op">$</span><span class="va">se</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="op">(</span><span class="va">rep_stats</span><span class="op">$</span><span class="va">se</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="op">(</span><span class="op">(</span><span class="va">disc_stats</span><span class="op">$</span><span class="va">se</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="op">(</span><span class="va">rep_stats</span><span class="op">$</span><span class="va">se</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## apply methods:</span></span>
<span><span class="va">out_EB_com</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/empirical_bayes.html">empirical_bayes</a></span><span class="op">(</span><span class="va">com_stats</span><span class="op">)</span></span>
<span><span class="va">out_boot_com</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/BR_ss.html">BR_ss</a></span><span class="op">(</span><span class="va">com_stats</span>,seed_opt<span class="op">=</span><span class="cn">TRUE</span>,seed<span class="op">=</span><span class="fl">2020</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## rearrange data frames with SNPs ordered 1,2,3.. </span></span>
<span><span class="va">out_EB_com</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">out_EB_com</span>,<span class="va">out_EB_com</span><span class="op">$</span><span class="va">rsid</span><span class="op">)</span></span>
<span><span class="va">out_boot_com</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">out_boot_com</span>,<span class="va">out_boot_com</span><span class="op">$</span><span class="va">rsid</span><span class="op">)</span></span>
<span><span class="va">out_EB_com</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>rsid <span class="op">=</span> <span class="va">disc_stats</span><span class="op">$</span><span class="va">rsid</span>, beta_disc <span class="op">=</span> <span class="va">disc_stats</span><span class="op">$</span><span class="va">beta</span>, se_disc  <span class="op">=</span> <span class="va">disc_stats</span><span class="op">$</span><span class="va">se</span>, beta_rep <span class="op">=</span><span class="va">rep_stats</span><span class="op">$</span><span class="va">beta</span>, se_rep <span class="op">=</span> <span class="va">rep_stats</span><span class="op">$</span><span class="va">se</span>, beta_EB<span class="op">=</span><span class="va">out_EB_com</span><span class="op">$</span><span class="va">beta_EB</span><span class="op">)</span></span>
<span><span class="va">out_boot_com</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>rsid <span class="op">=</span> <span class="va">disc_stats</span><span class="op">$</span><span class="va">rsid</span>, beta_disc <span class="op">=</span> <span class="va">disc_stats</span><span class="op">$</span><span class="va">beta</span>, se_disc  <span class="op">=</span> <span class="va">disc_stats</span><span class="op">$</span><span class="va">se</span>, beta_rep <span class="op">=</span><span class="va">rep_stats</span><span class="op">$</span><span class="va">beta</span>, se_rep <span class="op">=</span> <span class="va">rep_stats</span><span class="op">$</span><span class="va">se</span>, beta_boot<span class="op">=</span><span class="va">out_boot_com</span><span class="op">$</span><span class="va">beta_BR_ss</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## reorder data frames based on significance in discovery data set:</span></span>
<span><span class="va">out_EB_com</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">out_EB_com</span>, <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">out_EB_com</span><span class="op">$</span><span class="va">beta_disc</span><span class="op">/</span><span class="va">out_EB_com</span><span class="op">$</span><span class="va">se_disc</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">out_EB_com</span> <span class="op">&lt;-</span> <span class="va">out_EB_com</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">out_EB_com</span><span class="op">$</span><span class="va">beta_disc</span><span class="op">/</span><span class="va">out_EB_com</span><span class="op">$</span><span class="va">se_disc</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="op">(</span><span class="fl">5e-8</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, lower.tail<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">out_EB_com</span><span class="op">)</span></span>
<span><span class="co">#&gt;   rsid   beta_disc     se_disc    beta_rep      se_rep     beta_EB</span></span>
<span><span class="co">#&gt; 1 3965  0.05013020 0.006345754  0.04754268 0.006345754  0.04727749</span></span>
<span><span class="co">#&gt; 2 7815  0.05040019 0.006567997  0.03849648 0.006567997  0.04283479</span></span>
<span><span class="co">#&gt; 3 4998 -0.04856148 0.006458450 -0.04232183 0.006458450 -0.04185813</span></span>
<span><span class="co">#&gt; 4 7261  0.04649358 0.006342549  0.04167160 0.006342549  0.04252442</span></span>
<span><span class="co">#&gt; 5 6510  0.04611661 0.006499584  0.04135877 0.006499584  0.04214094</span></span>
<span><span class="co">#&gt; 6 9917  0.04489474 0.006333883  0.04504234 0.006333883  0.04341250</span></span>
<span></span>
<span><span class="va">out_boot_com</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">out_boot_com</span>, <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">out_boot_com</span><span class="op">$</span><span class="va">beta_disc</span><span class="op">/</span><span class="va">out_boot_com</span><span class="op">$</span><span class="va">se_disc</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">out_boot_com</span> <span class="op">&lt;-</span> <span class="va">out_boot_com</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">out_boot_com</span><span class="op">$</span><span class="va">beta_disc</span><span class="op">/</span><span class="va">out_boot_com</span><span class="op">$</span><span class="va">se_disc</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="op">(</span><span class="fl">5e-8</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, lower.tail<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">out_boot_com</span><span class="op">)</span></span>
<span><span class="co">#&gt;   rsid   beta_disc     se_disc    beta_rep      se_rep   beta_boot</span></span>
<span><span class="co">#&gt; 1 3965  0.05013020 0.006345754  0.04754268 0.006345754  0.04053099</span></span>
<span><span class="co">#&gt; 2 7815  0.05040019 0.006567997  0.03849648 0.006567997  0.04091237</span></span>
<span><span class="co">#&gt; 3 4998 -0.04856148 0.006458450 -0.04232183 0.006458450 -0.03823213</span></span>
<span><span class="co">#&gt; 4 7261  0.04649358 0.006342549  0.04167160 0.006342549  0.04008263</span></span>
<span><span class="co">#&gt; 5 6510  0.04611661 0.006499584  0.04135877 0.006499584  0.04034247</span></span>
<span><span class="co">#&gt; 6 9917  0.04489474 0.006333883  0.04504234 0.006333883  0.04036936</span></span></code></pre></div>
<p>We now compute similar evaluation metrics to above and produce the
two plots in order to demonstrate the performance of the above
approaches.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## rmse</span></span>
<span><span class="va">rmse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>disc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">out_CL</span><span class="op">$</span><span class="va">beta_disc</span> <span class="op">-</span> <span class="va">true_beta</span><span class="op">[</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>, rep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">out_CL</span><span class="op">$</span><span class="va">beta_rep</span> <span class="op">-</span> <span class="va">true_beta</span><span class="op">[</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>, EB_com <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">out_EB_com</span><span class="op">$</span><span class="va">beta_EB</span> <span class="op">-</span> <span class="va">true_beta</span><span class="op">[</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>, boot_com <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">out_boot_com</span><span class="op">$</span><span class="va">beta_boot</span> <span class="op">-</span> <span class="va">true_beta</span><span class="op">[</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">rmse</span></span>
<span><span class="co">#&gt;         disc         rep      EB_com    boot_com</span></span>
<span><span class="co">#&gt; 1 0.01486281 0.006825705 0.005684833 0.005689593</span></span>
<span></span>
<span><span class="co">## bias positive</span></span>
<span><span class="va">bias_up</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>disc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out_CL</span><span class="op">$</span><span class="va">beta_disc</span><span class="op">[</span><span class="va">pos_sigA</span><span class="op">]</span> <span class="op">-</span> <span class="va">true_beta</span><span class="op">[</span><span class="va">pos_sig</span><span class="op">]</span><span class="op">)</span>, rep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out_CL</span><span class="op">$</span><span class="va">beta_rep</span><span class="op">[</span><span class="va">pos_sigA</span><span class="op">]</span> <span class="op">-</span> <span class="va">true_beta</span><span class="op">[</span><span class="va">pos_sig</span><span class="op">]</span><span class="op">)</span>, EB_com <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out_EB_com</span><span class="op">$</span><span class="va">beta_EB</span><span class="op">[</span><span class="va">pos_sigA</span><span class="op">]</span> <span class="op">-</span> <span class="va">true_beta</span><span class="op">[</span><span class="va">pos_sig</span><span class="op">]</span><span class="op">)</span>, boot_com <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out_boot_com</span><span class="op">$</span><span class="va">beta_boot</span><span class="op">[</span><span class="va">pos_sigA</span><span class="op">]</span> <span class="op">-</span> <span class="va">true_beta</span><span class="op">[</span><span class="va">pos_sig</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bias_up</span></span>
<span><span class="co">#&gt;        disc           rep     EB_com     boot_com</span></span>
<span><span class="co">#&gt; 1 0.0126302 -0.0004286069 0.00253731 0.0006846572</span></span>
<span></span>
<span><span class="co">## bias negative</span></span>
<span><span class="va">bias_down</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>disc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out_CL</span><span class="op">$</span><span class="va">beta_disc</span><span class="op">[</span><span class="va">neg_sigA</span><span class="op">]</span> <span class="op">-</span> <span class="va">true_beta</span><span class="op">[</span><span class="va">neg_sig</span><span class="op">]</span><span class="op">)</span>, rep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out_CL</span><span class="op">$</span><span class="va">beta_rep</span><span class="op">[</span><span class="va">neg_sigA</span><span class="op">]</span> <span class="op">-</span> <span class="va">true_beta</span><span class="op">[</span><span class="va">neg_sig</span><span class="op">]</span><span class="op">)</span>, EB_com <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out_EB_com</span><span class="op">$</span><span class="va">beta_EB</span><span class="op">[</span><span class="va">neg_sigA</span><span class="op">]</span> <span class="op">-</span> <span class="va">true_beta</span><span class="op">[</span><span class="va">neg_sig</span><span class="op">]</span><span class="op">)</span>, boot_com <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out_boot_com</span><span class="op">$</span><span class="va">beta_boot</span><span class="op">[</span><span class="va">neg_sigA</span><span class="op">]</span> <span class="op">-</span> <span class="va">true_beta</span><span class="op">[</span><span class="va">neg_sig</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bias_down</span></span>
<span><span class="co">#&gt;          disc          rep     EB_com     boot_com</span></span>
<span><span class="co">#&gt; 1 -0.01172448 -0.001100763 -0.0026626 -0.002291323</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">all_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>rsid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span>, beta_disc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">out_CL</span><span class="op">$</span><span class="va">beta_disc</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span>, se_disc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">out_CL</span><span class="op">$</span><span class="va">se_disc</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span>, adj_beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">out_CL</span><span class="op">$</span><span class="va">beta_disc</span>,<span class="va">out_CL</span><span class="op">$</span><span class="va">beta_rep</span>,<span class="va">out_EB_com</span><span class="op">$</span><span class="va">beta_EB</span>,<span class="va">out_boot_com</span><span class="op">$</span><span class="va">beta_boot</span><span class="op">)</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"disc"</span>,<span class="fl">34</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"rep"</span>,<span class="fl">34</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"EB_com"</span>,<span class="fl">34</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"boot_com"</span>,<span class="fl">34</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">all_results</span><span class="op">$</span><span class="va">rmse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="va">all_results</span><span class="op">$</span><span class="va">adj_beta</span> <span class="op">-</span> <span class="va">true_beta</span><span class="op">[</span><span class="va">all_results</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">all_results</span><span class="op">$</span><span class="va">method</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">all_results</span><span class="op">$</span><span class="va">method</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"disc"</span>,<span class="st">"rep"</span>,<span class="st">"EB_com"</span>, <span class="st">"boot_com"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">all_results</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">method</span>,y<span class="op">=</span><span class="va">rmse</span>,fill<span class="op">=</span><span class="va">method</span>, color<span class="op">=</span><span class="va">method</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">0.7</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">method</span>, color<span class="op">=</span><span class="va">method</span>, alpha<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">col</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">col</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>  <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Method"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"RMSE of sig. SNPs at  "</span>, <span class="fl">5</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept<span class="op">=</span><span class="fl">0</span>, colour<span class="op">=</span><span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle<span class="op">=</span><span class="fl">90</span>, vjust<span class="op">=</span><span class="fl">0.5</span>, hjust<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">10</span><span class="op">)</span>,legend.position <span class="op">=</span> <span class="st">"none"</span>, strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face<span class="op">=</span><span class="st">"italic"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">true</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>rsid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span><span class="op">)</span>, beta_disc <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">out_CL</span><span class="op">$</span><span class="va">beta_disc</span><span class="op">)</span>, se_disc <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">out_CL</span><span class="op">$</span><span class="va">se_disc</span><span class="op">)</span>,adj_beta<span class="op">=</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out_CL</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span>,method<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"true"</span>,<span class="fl">34</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">all_resultsA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">all_results</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,<span class="va">true</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">all_resultsA</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">adj_beta</span><span class="op">)</span>,colour<span class="op">=</span><span class="va">method</span>,fill<span class="op">=</span><span class="va">method</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">0.05</span>,size<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">col</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">8</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">col</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">8</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.01</span>,<span class="fl">0.08</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"|"</span>, <span class="va">beta</span>, <span class="st">"| "</span> , <span class="st">"of sig. SNPs at  "</span>, <span class="fl">5</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">10</span><span class="op">)</span>,legend.position<span class="op">=</span><span class="st">"bottom"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Method"</span>,colour<span class="op">=</span><span class="st">"Method"</span><span class="op">)</span> <span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>nrow<span class="op">=</span><span class="fl">2</span>,byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="discovery_replication_files/figure-html/unnamed-chunk-15-1.png" width="345.6"><img src="discovery_replication_files/figure-html/unnamed-chunk-15-2.png" width="345.6"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Amanda Forde.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
