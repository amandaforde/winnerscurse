<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Standard errors and confidence intervals of adjusted estimates • winnerscurse</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Standard errors and confidence intervals of adjusted estimates">
<meta property="og:description" content="winnerscurse">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">winnerscurse</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/amandaforde/winners_curse" class="external-link">Source</a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Standard errors and confidence intervals of
adjusted estimates</h1>
            
      
      
      <div class="hidden name"><code>standard_errors_confidence_intervals.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://amandaforde.github.io/winnerscurse/" class="external-link">winnerscurse</a></span><span class="op">)</span></span></code></pre></div>
<p>This third vignette briefly illustrates how our R package,
<code>winnerscurse</code>, can be used to generate <strong>standard
errors</strong> and <strong>confidence intervals</strong> for certain
adjusted association estimates, obtained using the <em>‘discovery
only’</em> <em>Winner’s Curse</em> correction methods. Here, we
demonstrate the functionality of the functions, <code>se_adjust</code>
and <code>cl_interval</code>, using a simulated data set of GWAS summary
statistics and discuss the properties of each function. We create the
same toy data set as that used in the <a href="https://amandaforde.github.io/winnerscurse/articles/winners_curse_methods.html" class="external-link">first
vignette</a>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1998</span><span class="op">)</span></span>
<span><span class="va">sim_dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_stats.html">sim_stats</a></span><span class="op">(</span>nsnp<span class="op">=</span><span class="fl">10</span><span class="op">^</span><span class="fl">6</span>,h2<span class="op">=</span><span class="fl">0.4</span>,prop_effect<span class="op">=</span><span class="fl">0.01</span>,nid<span class="op">=</span><span class="fl">50000</span><span class="op">)</span></span>
<span><span class="co">## simulated GWAS summary statistics</span></span>
<span><span class="va">summary_stats</span> <span class="op">&lt;-</span> <span class="va">sim_dataset</span><span class="op">$</span><span class="va">disc</span></span></code></pre></div>
<div class="section level3">
<h3 id="standard-errors-of-adjusted-estimates">Standard errors of adjusted estimates<a class="anchor" aria-label="anchor" href="#standard-errors-of-adjusted-estimates"></a>
</h3>
<ul>
<li>
<p>The function <code>se_adjust</code> has three parameters:</p>
<ol style="list-style-type: decimal">
<li>
<code>summary_data</code>: a data frame in the form as described
previously, with columns <code>rsid</code>, <code>beta</code> and
<code>se</code>
</li>
<li>
<code>method</code>: the user is required to specify which
<em>‘discovery only’</em> method they wish to implement in order to
obtain standard errors; <code>"empirical_bayes"</code>,
<code>"BR_ss"</code> or <code>"FDR_IQT"</code>, which represent the use
of the empirical Bayes method, the bootstrap method, or FDR Inverse
Quantile Transformation, respectively. All three <em>Winner’s Curse</em>
correction methods are detailed in the <a href="https://amandaforde.github.io/winnerscurse/articles/winners_curse_methods.html" class="external-link">first
vignette</a>.</li>
<li>
<code>n_boot</code>: a numerical value which defines the number of
bootstraps to be used, the default option is 100 bootstraps,
<code>n_boot=100</code>. The function requires that this number is
greater than 1.</li>
</ol>
</li>
<li><p><code>se_adjust</code> outputs a data frame in a similar format
to other functions included in this R package. It includes the
<code>beta</code> estimates obtained after adjustment using the
specified method, <code>method</code>, as well as an additional column
<code>adj_se</code>. This column contains a value which approximates the
standard error of the adjusted association estimate.</p></li>
<li><p><code>se_adjust</code> uses a parametric bootstrap approach.
Firstly, using the inputted data set, <code>n_boot</code> individual
data sets are created as follows. For each bootstrap <span class="math inline">\(\text{b} = 1, \dots\)</span><code>n_boot</code>, a
value for <span class="math inline">\(\hat\beta^{(\text{b})}\)</span> is
generated for each SNP from a normal distribution centred at the naive
<span class="math inline">\(\hat\beta\)</span> with standard error,
<span class="math inline">\(\text{se}(\hat\beta)\)</span>: <span class="math display">\[\hat\beta^{(\text{b})} \sim N(\hat\beta,
\text{se}(\hat\beta)).\]</span></p></li>
<li><p>The specified method, <code>method</code>, is then implemented on
each of the <code>n_boot</code> data sets and so for each SNP, we now
have <code>n_boot</code> <em>adjusted ‘bootstrapped’</em> <span class="math inline">\(\hat\beta\)</span> estimates. The standard error
is then easily obtained by applying the function <code>sd</code> to this
set of adjusted estimates for each SNP.</p></li>
<li><p>It is important to note that the use of bootstrapping with large
data sets can be quite <strong><em>computationally
intensive</em></strong>. On a personal computer, executing 100
bootstraps can result in <code>se_adjust</code> taking between 1 and 3
minutes to provide an output with a data set such as the one described
here. As expected, <code>BR_ss</code> tends to take the longest of the
three methods.</p></li>
<li><p>An example of the implementation of this function for each of the
three methods is given below. For ease of demonstration, a mere 10
bootstraps is used on all occasions. However, a value of
<code>n_boot</code> as small as this is not advised in
practice.</p></li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_EB</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/se_adjust.html">se_adjust</a></span><span class="op">(</span>summary_data <span class="op">=</span> <span class="va">summary_stats</span>, method <span class="op">=</span> <span class="st">"empirical_bayes"</span>, n_boot<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">out_EB</span><span class="op">)</span></span>
<span><span class="co">#&gt;   rsid        beta          se     beta_EB      adj_se</span></span>
<span><span class="co">#&gt; 1 7815  0.04771727 0.006568299  0.04599530 0.008669139</span></span>
<span><span class="co">#&gt; 2 3965  0.04609999 0.006346232  0.04443623 0.008500261</span></span>
<span><span class="co">#&gt; 3 4998 -0.04527792 0.006458823 -0.03999539 0.010010348</span></span>
<span><span class="co">#&gt; 4 9917  0.04164616 0.006334188  0.03998556 0.004601265</span></span>
<span><span class="co">#&gt; 5 7261  0.04162686 0.006343244  0.03996389 0.008016920</span></span>
<span><span class="co">#&gt; 6 6510  0.04254046 0.006500057  0.04083638 0.009074620</span></span>
<span></span>
<span><span class="va">out_BR_ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/se_adjust.html">se_adjust</a></span><span class="op">(</span>summary_data <span class="op">=</span> <span class="va">summary_stats</span>, method <span class="op">=</span> <span class="st">"BR_ss"</span>, n_boot<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">out_BR_ss</span><span class="op">)</span></span>
<span><span class="co">#&gt;   rsid        beta          se  beta_BR_ss      adj_se</span></span>
<span><span class="co">#&gt; 1 7815  0.04771727 0.006568299  0.03499261 0.006790539</span></span>
<span><span class="co">#&gt; 2 3965  0.04609999 0.006346232  0.03380467 0.006879619</span></span>
<span><span class="co">#&gt; 3 4998 -0.04527792 0.006458823 -0.03203960 0.002972599</span></span>
<span><span class="co">#&gt; 4 9917  0.04164616 0.006334188  0.02836485 0.004280097</span></span>
<span><span class="co">#&gt; 5 7261  0.04162686 0.006343244  0.02830782 0.004225297</span></span>
<span><span class="co">#&gt; 6 6510  0.04254046 0.006500057  0.02886472 0.004706941</span></span>
<span></span>
<span><span class="va">out_FIQT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/se_adjust.html">se_adjust</a></span><span class="op">(</span>summary_data <span class="op">=</span> <span class="va">summary_stats</span>, method <span class="op">=</span> <span class="st">"FDR_IQT"</span>, n_boot<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">out_FIQT</span><span class="op">)</span></span>
<span><span class="co">#&gt;   rsid        beta          se   beta_FIQT      adj_se</span></span>
<span><span class="co">#&gt; 1 7815  0.04771727 0.006568299  0.03422825 0.009403474</span></span>
<span><span class="co">#&gt; 2 3965  0.04609999 0.006346232  0.03307103 0.007694662</span></span>
<span><span class="co">#&gt; 3 4998 -0.04527792 0.006458823 -0.03188772 0.009541773</span></span>
<span><span class="co">#&gt; 4 9917  0.04164616 0.006334188  0.02823824 0.007188336</span></span>
<span><span class="co">#&gt; 5 7261  0.04162686 0.006343244  0.02827861 0.006387643</span></span>
<span><span class="co">#&gt; 6 6510  0.04254046 0.006500057  0.02897770 0.004577303</span></span></code></pre></div>
<p><span style="color: blue;"><span class="math inline">\(\star\)</span></span> <strong>Note:</strong> Due
to the nature of the conditional likelihood methods, i.e. adjustments
are only made to association estimates of SNPs with <span class="math inline">\(p\)</span>-values less than a chosen significance
threshold, it is not possible to obtain standard errors of the
conditional likelihood adjusted association estimates in the above
manner.</p>
<p><span style="color: blue;"><span class="math inline">\(\star\)</span></span> <strong>Note:</strong>
Currently, this package does not provide a way to create confidence
intervals for adjusted association estimates obtained using the three
methods mentioned above, empirical Bayes, FDR Inverse Quantile
Transformation and bootstrap. However, one option that could be
considered is to take an approach similar to that of
<code>se_adjust</code> and obtain quantiles by means of parametric
bootstrap. Unfortunately, in order to ensure accurate quantiles, this
would require many <code>n_boot</code> simulated data sets to which the
correction method of choice is applied, resulting in a very
computationally intensive process. For this reason, a function that
would generate suitable quantiles for each adjusted association estimate
has been omitted from the R package for now.</p>
</div>
<div class="section level3">
<h3 id="confidence-intervals-for-estimates-adjusted-by-conditional-likelihood-methods">Confidence intervals for estimates adjusted by conditional
likelihood methods<a class="anchor" aria-label="anchor" href="#confidence-intervals-for-estimates-adjusted-by-conditional-likelihood-methods"></a>
</h3>
<ul>
<li><p>The function <code>cl_interval</code> implements the conditional
likelihood methods described in <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2665019/" class="external-link">Ghosh
<em>et al.</em> (2008)</a> for each significant SNP and together with
the three adjusted estimates, provides a single confidence interval for
each SNP. As well as a data set in the form of a data frame with columns
<code>rsid</code>, <code>beta</code> and <code>se</code>,
<code>cl_interval</code> requires <code>alpha</code>, a value which
specifies the significance threshold and <code>conf</code>, a value
between 0 and 1 which determines the confidence interval. The default
setting for <code>conf</code> is 0.95.</p></li>
<li><p>This confidence interval for the adjusted estimate is specified
in <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2665019/" class="external-link">Ghosh
<em>et al.</em> (2008)</a>. With <span class="math inline">\(\mu =
\frac{\beta}{\text{se}(\beta)}\)</span> and <span class="math inline">\(z =
\frac{\hat\beta}{\hat{\text{se}(\hat\beta)}}\)</span>, consider the
acceptance region <span class="math inline">\(A(\mu,1-\eta)\)</span>,
which is defined as the interval between the <span class="math inline">\(\eta/2\)</span> and <span class="math inline">\(1-\eta/2\)</span> quantiles of the conditional
density, <span class="math inline">\(p_{\mu}(z | \mid Z \mid &gt; c
)\)</span>. Having obtained the lower and upper boundaries of this
acceptance region, the desired confidence interval is given as: <span class="math display">\[(\mu_{\text{lower}}\hat{\text{se}(\hat\beta)},
\mu_{\text{upper}}\hat{\text{se}(\hat\beta)}).\]</span></p></li>
<li><p>In the output of <code>cl_interval</code>, the <code>lower</code>
column holds the values of the lower confidence limit for each SNP while
the <code>upper</code> column contains the upper confidence
limit.</p></li>
<li><p>If no SNPs are detected as significant, the function returns a
warning message:
<code>WARNING: There are no significant SNPs at this threshold</code>.</p></li>
<li><p><code>cl_interval</code> can be used in conjunction with the toy
data set as shown below, in which <code>alpha</code> is specified as
<code>5e-8</code> and a <strong>95%</strong> confidence interval is
desired:</p></li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cl_interval.html">cl_interval</a></span><span class="op">(</span>summary_data<span class="op">=</span><span class="va">summary_stats</span>, alpha <span class="op">=</span> <span class="fl">5e-8</span>, conf_level<span class="op">=</span><span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="co">#&gt;   rsid        beta          se    beta.cl1    beta.cl2    beta.cl3       lower</span></span>
<span><span class="co">#&gt; 1 7815  0.04771727 0.006568299  0.04709173  0.04575084  0.04642129  0.02855506</span></span>
<span><span class="co">#&gt; 2 3965  0.04609999 0.006346232  0.04549476  0.04419814  0.04484645  0.02758022</span></span>
<span><span class="co">#&gt; 3 4998 -0.04527792 0.006458823 -0.04421716 -0.04238468 -0.04330092 -0.05716545</span></span>
<span><span class="co">#&gt; 4 9917  0.04164616 0.006334188  0.03909824  0.03598923  0.03754373  0.01349641</span></span>
<span><span class="co">#&gt; 5 7261  0.04162686 0.006343244  0.03900942  0.03584977  0.03742959  0.01319315</span></span>
<span><span class="co">#&gt; 6 6510  0.04254046 0.006500057  0.03975867  0.03645266  0.03810567  0.01304579</span></span>
<span><span class="co">#&gt;         upper</span></span>
<span><span class="co">#&gt; 1  0.06008004</span></span>
<span><span class="co">#&gt; 2  0.05804426</span></span>
<span><span class="co">#&gt; 3 -0.02376903</span></span>
<span><span class="co">#&gt; 4  0.05248926</span></span>
<span><span class="co">#&gt; 5  0.05245207</span></span>
<span><span class="co">#&gt; 6  0.05358307</span></span></code></pre></div>
<p><span style="color: blue;"><span class="math inline">\(\star\)</span></span> <strong>Note:</strong>
Similar to <code>condlike_rep</code> discussed in the <a href="https://amandaforde.github.io/winnerscurse/articles/discovery_replication.html" class="external-link">second
vignette</a>, <code>cl_interval</code> also uses the R function
<code>uniroot</code> which generates values for <code>upper</code> and
<code>lower</code> numerically and thus, we advise users to be cautious
of <code>uniroot</code>’s possible failure to obtain appropriate values
in certain circumstances. In practice, this failure has been witnessed
to occur very rarely. However, in order to ensure a greater possibility
that <code>cl_interval</code> will produce appropriate confidence
intervals for each significant SNPs, <code>cl_interval</code> can only
be used with data sets in which the absolute value of the
<strong>largest naive <span class="math inline">\(z\)</span>-statistic
is less than 150</strong>.</p>
<p>In the final part of this vignette, we will evaluate and visualise
the above obtained confidence intervals. Firstly, we will consider
computing the <strong><em>coverage</em></strong> of these confidence
intervals for the significant SNPs, i.e. we calculate what percentage of
these confidence intervals contain the true association estimate, as
shown below.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Simulated true effect sizes:</span></span>
<span><span class="va">true_beta</span> <span class="op">&lt;-</span> <span class="va">sim_dataset</span><span class="op">$</span><span class="va">true</span><span class="op">$</span><span class="va">true_beta</span><span class="op">[</span><span class="va">out</span><span class="op">$</span><span class="va">rsid</span><span class="op">]</span></span>
<span></span>
<span><span class="co">## coverage</span></span>
<span><span class="va">coverage</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">true_beta</span> <span class="op">&gt;</span> <span class="va">out</span><span class="op">$</span><span class="va">lower</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">true_beta</span> <span class="op">&lt;</span> <span class="va">out</span><span class="op">$</span><span class="va">upper</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">true_beta</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span></span>
<span><span class="va">coverage</span></span>
<span><span class="co">#&gt; [1] 96.9697</span></span></code></pre></div>
<p>Next, we construct a <em>simple forest plot</em> to illustrate the
adjusted association estimates and corresponding confidence intervals
for each SNP in our simulated data set. Of the three conditional
likelihood adjusted estimates, we include <code>beta.cl2</code> as the
<strong>effect size</strong> in our plot.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">RColorBrewer</span><span class="op">)</span></span>
<span><span class="va">col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">8</span>,<span class="st">"Dark2"</span><span class="op">)</span></span>
<span><span class="va">out</span><span class="op">$</span><span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">33</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">out</span><span class="op">$</span><span class="va">pos</span> <span class="op">&lt;-</span> <span class="va">out</span><span class="op">$</span><span class="va">beta</span> <span class="op">&gt;</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">out</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">index</span>, x<span class="op">=</span><span class="va">beta.cl2</span>, xmin<span class="op">=</span><span class="va">lower</span>, xmax<span class="op">=</span><span class="va">upper</span>, color<span class="op">=</span><span class="va">pos</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_errorbarh.html" class="external-link">geom_errorbarh</a></span><span class="op">(</span>height<span class="op">=</span><span class="fl">.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">col</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="va">col</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"SNP ID"</span>, breaks<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span>, labels<span class="op">=</span><span class="va">out</span><span class="op">$</span><span class="va">rsid</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Effect size of sig. SNPs at  "</span>, <span class="fl">5</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept<span class="op">=</span><span class="fl">0</span>, colour<span class="op">=</span><span class="st">"black"</span>,linetype<span class="op">=</span><span class="st">'dashed'</span>, alpha<span class="op">=</span><span class="fl">.5</span><span class="op">)</span> <span class="op">+</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">10</span><span class="op">)</span>,legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span> </span></code></pre></div>
<p><img src="standard_errors_confidence_intervals_files/figure-html/unnamed-chunk-6-1.png" width="624"></p>
<p><span class="math inline">\(~\)</span> <span class="math inline">\(~\)</span></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Amanda Forde.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
